{
  "name": "Agent Comptable ğŸ“Š",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "comptable",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-node",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        250,
        300
      ],
      "webhookId": ""
    },
    {
      "parameters": {
        "jsCode": "const userMessage = $input.first().json.body.message || \"\";\nconst agentId = $input.first().json.body.agentId || \"comptable\";\nconst conversationId = $input.first().json.body.conversationId || \"\";\n\n// RÃ©ponses intelligentes selon le message\nconst responses = {\n  facture: \"ğŸ“„ Parfait ! Pour gÃ©nÃ©rer une facture, j'ai besoin de :\\n\\n1. **Nom du client**\\n2. **Prestations** (description + montant HT)\\n3. **Date de facturation**\\n4. **NumÃ©ro de facture** (ex: FAC-2025-001)\\n\\nVous pouvez me dÃ©poser un modÃ¨le ou me donner ces infos ! ğŸ’¼\",\n  \n  depense: \"ğŸ“Š Excellent ! Pour analyser vos dÃ©penses :\\n\\n**Options :**\\nâ€¢ ğŸ“ DÃ©posez vos relevÃ©s bancaires (PDF/CSV)\\nâ€¢ ğŸ“ˆ Rapport dÃ©taillÃ© par catÃ©gorie\\nâ€¢ âš ï¸ DÃ©tection dÃ©penses inhabituelles\\nâ€¢ ğŸ’¡ Suggestions d'optimisation\\n\\nQuelle pÃ©riode analyser ? ğŸ“…\",\n  \n  rapport: \"ğŸ“ˆ Rapport mensuel en prÃ©paration...\\n\\n**Inclus :**\\nâœ… CA du mois\\nâœ… DÃ©penses par catÃ©gorie\\nâœ… Marges et rentabilitÃ©\\nâœ… Comparatif mois prÃ©cÃ©dent\\nâœ… PrÃ©visions\\n\\nGraphiques visuels souhaitÃ©s ? ğŸ“Š\",\n  \n  tva: \"ğŸ’¶ VÃ©rification TVA...\\n\\n**ContrÃ´les :**\\n1. âœ… TVA collectÃ©e (ventes)\\n2. âœ… TVA dÃ©ductible (achats)\\n3. âœ… Solde Ã  payer/rÃ©cupÃ©rer\\n4. âœ… Ã‰chÃ©ances dÃ©claration\\n\\nDÃ©posez vos factures pour analyse auto ! ğŸ“‹\",\n  \n  default: \"Bonjour ! ğŸ“Š Agent Comptable Ã  votre service.\\n\\n**Mes spÃ©cialitÃ©s :**\\nâ€¢ ğŸ§¾ Factures professionnelles\\nâ€¢ ğŸ“Š Analyse dÃ©penses\\nâ€¢ ğŸ“ˆ Rapports mensuels\\nâ€¢ ğŸ’¶ Gestion TVA\\n\\nComment puis-je vous aider ? ğŸ’¼\"\n};\n\nconst msgLower = userMessage.toLowerCase();\nlet response = responses.default;\n\nif (msgLower.includes(\"facture\")) response = responses.facture;\nelse if (msgLower.includes(\"dÃ©pense\") || msgLower.includes(\"depense\") || msgLower.includes(\"cout\") || msgLower.includes(\"analyse\")) response = responses.depense;\nelse if (msgLower.includes(\"rapport\") || msgLower.includes(\"mensuel\") || msgLower.includes(\"bilan\")) response = responses.rapport;\nelse if (msgLower.includes(\"tva\")) response = responses.tva;\n\nreturn {\n  json: {\n    success: true,\n    response,\n    agentId,\n    conversationId,\n    timestamp: new Date().toISOString()\n  }\n};"
      },
      "id": "code-node",
      "name": "Process Message",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        450,
        300
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}"
      },
      "id": "respond-node",
      "name": "Respond",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        650,
        300
      ]
    }
  ],
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Process Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Message": {
      "main": [
        [
          {
            "node": "Respond",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "local"
  },
  "id": "",
  "tags": []
}
