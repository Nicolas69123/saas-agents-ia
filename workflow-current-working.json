{
  "updatedAt": "2025-12-28T19:59:25.358Z",
  "createdAt": "2025-12-26T22:11:28.474Z",
  "id": "J5Phg4QikbYSJjsv",
  "name": "AGENT IA MARKETING ( A UTILISER SUR LE SITE WEB ) copy",
  "description": null,
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "f8940e10-7f82-499f-9fea-e11897a5bd8a",
        "responseMode": "lastNode",
        "options": {}
      },
      "id": "42c452ae-30d8-4a6a-969c-c8dc5fcb7c1d",
      "name": "Webhook - Receive Campaign Brief",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -5024,
        2288
      ],
      "webhookId": "f8940e10-7f82-499f-9fea-e11897a5bd8a"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "id-1",
              "name": "bufferApiUrl",
              "value": "https://api.bufferapp.com/1",
              "type": "string"
            },
            {
              "id": "id-2",
              "name": "bufferAccessToken",
              "value": "<__PLACEHOLDER_VALUE__Buffer API Access Token__>",
              "type": "string"
            },
            {
              "id": "id-3",
              "name": "reportRecipientEmail",
              "value": "<__PLACEHOLDER_VALUE__Email address for performance reports__>",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "id": "06aab1f0-4f00-42ff-9ed1-702cadaecb69",
      "name": "Workflow Configuration",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -4784,
        2288
      ]
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "mode": "list",
          "value": ""
        },
        "responses": {
          "values": [
            {}
          ]
        },
        "builtInTools": {},
        "options": {}
      },
      "id": "e03669e0-5966-405f-92d1-c46b4c9ee7a1",
      "name": "Analyze Brief with AI",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 2,
      "position": [
        -5008,
        2496
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googlePalmApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": \"={{ $json.output.prompt_ameliore }}\"\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"temperature\": 0.7\n  }\n}",
        "options": {
          "response": {
            "response": {}
          }
        }
      },
      "id": "9b7c9596-e27a-4aa9-bb04-028e0a38b247",
      "name": "Generate Image - DALL-E API",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -2416,
        1808
      ]
    },
    {
      "parameters": {
        "operation": "classify",
        "options": {}
      },
      "id": "3d8f59eb-587f-4fa5-9c29-2fe0cc2625ac",
      "name": "Generate Video Script",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 2,
      "position": [
        -5296,
        2464
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "<__PLACEHOLDER_VALUE__Video generation API endpoint (Synthesia, Runway, HeyGen, etc.)__>",
        "authentication": "genericCredentialType",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"script\": {{ $('Generate Video Script').item.json.text }},\n  \"topic\": {{ $json.body.topic }}\n}",
        "options": {}
      },
      "id": "bcb43c9c-925c-4373-b063-450c2ad293b8",
      "name": "Generate Video - API",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -896,
        736
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $('Workflow Configuration').first().json.bufferApiUrl }}/updates/create.json",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "access_token",
              "value": "={{ $('Workflow Configuration').first().json.bufferAccessToken }}"
            },
            {
              "name": "profile_ids[]",
              "value": "<__PLACEHOLDER_VALUE__Buffer Profile ID for target platform__>"
            },
            {
              "name": "text",
              "value": "={{ $json.text || $json.body.topic }}"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "c2853353-d9fb-4599-9d56-8d4b92c000c7",
      "name": "Publish to Platform - Buffer API",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -496,
        704
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"status\": \"success\",\n  \"message\": \"Content published successfully\",\n  \"postId\": \"={{ $json.id }}\"\n}",
        "options": {}
      },
      "id": "95688f18-f4a7-4bde-b945-1d0064120c20",
      "name": "Respond - Content Published",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        304,
        640
      ]
    },
    {
      "parameters": {
        "amount": 7,
        "unit": "days"
      },
      "id": "dd1ccf19-38e0-471e-9011-10c3fef2dd0b",
      "name": "Wait 7 Days",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        0,
        0
      ],
      "webhookId": "3f1dbe8a-ffe4-46da-aa27-9ff9c612ee87"
    },
    {
      "parameters": {
        "url": "={{ $('Workflow Configuration').first().json.bufferApiUrl }}/updates/{{ $('Publish to Platform - Buffer API').item.json.id }}.json",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "access_token",
              "value": "={{ $('Workflow Configuration').first().json.bufferAccessToken }}"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "13622e60-856e-4ded-969b-45e269b6ad27",
      "name": "Fetch Performance Stats",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        560,
        16
      ]
    },
    {
      "parameters": {
        "jsCode": "// Format performance data into a readable report\nconst items = $input.all();\n\nlet totalLikes = 0;\nlet totalShares = 0;\nlet totalClicks = 0;\nlet totalImpressions = 0;\nlet totalEngagements = 0;\n\nconst performanceData = [];\n\n// Process each item and calculate totals\nfor (const item of items) {\n  const data = item.json;\n  \n  const likes = data.likes || 0;\n  const shares = data.shares || 0;\n  const clicks = data.clicks || 0;\n  const impressions = data.impressions || 0;\n  const engagements = likes + shares + clicks;\n  const engagementRate = impressions > 0 ? ((engagements / impressions) * 100).toFixed(2) : 0;\n  \n  totalLikes += likes;\n  totalShares += shares;\n  totalClicks += clicks;\n  totalImpressions += impressions;\n  totalEngagements += engagements;\n  \n  performanceData.push({\n    platform: data.platform || 'Unknown',\n    contentType: data.contentType || 'Unknown',\n    likes,\n    shares,\n    clicks,\n    impressions,\n    engagements,\n    engagementRate: `${engagementRate}%`\n  });\n}\n\n// Calculate overall engagement rate\nconst overallEngagementRate = totalImpressions > 0 \n  ? ((totalEngagements / totalImpressions) * 100).toFixed(2) \n  : 0;\n\n// Create summary text\nconst summaryText = `\n\ud83d\udcca CAMPAIGN PERFORMANCE REPORT\n================================\n\n\ud83d\udcc8 Overall Statistics:\n- Total Impressions: ${totalImpressions.toLocaleString()}\n- Total Engagements: ${totalEngagements.toLocaleString()}\n- Total Likes: ${totalLikes.toLocaleString()}\n- Total Shares: ${totalShares.toLocaleString()}\n- Total Clicks: ${totalClicks.toLocaleString()}\n- Overall Engagement Rate: ${overallEngagementRate}%\n\n\ud83d\udccb Detailed Breakdown:\n${performanceData.map((item, index) => `\n${index + 1}. ${item.platform} - ${item.contentType}\n   Impressions: ${item.impressions.toLocaleString()}\n   Likes: ${item.likes.toLocaleString()}\n   Shares: ${item.shares.toLocaleString()}\n   Clicks: ${item.clicks.toLocaleString()}\n   Engagement Rate: ${item.engagementRate}`).join('\\n')}\n`;\n\n// Create CSV data\nconst csvHeaders = 'Platform,Content Type,Impressions,Likes,Shares,Clicks,Engagements,Engagement Rate\\n';\nconst csvRows = performanceData.map(item => \n  `${item.platform},${item.contentType},${item.impressions},${item.likes},${item.shares},${item.clicks},${item.engagements},${item.engagementRate}`\n).join('\\n');\nconst csvData = csvHeaders + csvRows;\n\n// Create HTML report\nconst reportHtml = `\n<!DOCTYPE html>\n<html>\n<head>\n  <style>\n    body {\n      font-family: Arial, sans-serif;\n      line-height: 1.6;\n      color: #333;\n      max-width: 800px;\n      margin: 0 auto;\n      padding: 20px;\n    }\n    h1 {\n      color: #2c3e50;\n      border-bottom: 3px solid #3498db;\n      padding-bottom: 10px;\n    }\n    h2 {\n      color: #34495e;\n      margin-top: 30px;\n    }\n    .stats-grid {\n      display: grid;\n      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n      gap: 15px;\n      margin: 20px 0;\n    }\n    .stat-card {\n      background: #f8f9fa;\n      border-left: 4px solid #3498db;\n      padding: 15px;\n      border-radius: 4px;\n    }\n    .stat-label {\n      font-size: 12px;\n      color: #7f8c8d;\n      text-transform: uppercase;\n      margin-bottom: 5px;\n    }\n    .stat-value {\n      font-size: 24px;\n      font-weight: bold;\n      color: #2c3e50;\n    }\n    table {\n      width: 100%;\n      border-collapse: collapse;\n      margin: 20px 0;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    }\n    th {\n      background: #3498db;\n      color: white;\n      padding: 12px;\n      text-align: left;\n      font-weight: 600;\n    }\n    td {\n      padding: 12px;\n      border-bottom: 1px solid #ecf0f1;\n    }\n    tr:hover {\n      background: #f8f9fa;\n    }\n    .engagement-rate {\n      font-weight: bold;\n      color: #27ae60;\n    }\n  </style>\n</head>\n<body>\n  <h1>\ud83d\udcca Campaign Performance Report</h1>\n  \n  <h2>\ud83d\udcc8 Overall Statistics</h2>\n  <div class=\"stats-grid\">\n    <div class=\"stat-card\">\n      <div class=\"stat-label\">Total Impressions</div>\n      <div class=\"stat-value\">${totalImpressions.toLocaleString()}</div>\n    </div>\n    <div class=\"stat-card\">\n      <div class=\"stat-label\">Total Engagements</div>\n      <div class=\"stat-value\">${totalEngagements.toLocaleString()}</div>\n    </div>\n    <div class=\"stat-card\">\n      <div class=\"stat-label\">Total Likes</div>\n      <div class=\"stat-value\">${totalLikes.toLocaleString()}</div>\n    </div>\n    <div class=\"stat-card\">\n      <div class=\"stat-label\">Total Shares</div>\n      <div class=\"stat-value\">${totalShares.toLocaleString()}</div>\n    </div>\n    <div class=\"stat-card\">\n      <div class=\"stat-label\">Total Clicks</div>\n      <div class=\"stat-value\">${totalClicks.toLocaleString()}</div>\n    </div>\n    <div class=\"stat-card\">\n      <div class=\"stat-label\">Engagement Rate</div>\n      <div class=\"stat-value engagement-rate\">${overallEngagementRate}%</div>\n    </div>\n  </div>\n  \n  <h2>\ud83d\udccb Detailed Breakdown</h2>\n  <table>\n    <thead>\n      <tr>\n        <th>Platform</th>\n        <th>Content Type</th>\n        <th>Impressions</th>\n        <th>Likes</th>\n        <th>Shares</th>\n        <th>Clicks</th>\n        <th>Engagements</th>\n        <th>Engagement Rate</th>\n      </tr>\n    </thead>\n    <tbody>\n      ${performanceData.map(item => `\n        <tr>\n          <td>${item.platform}</td>\n          <td>${item.contentType}</td>\n          <td>${item.impressions.toLocaleString()}</td>\n          <td>${item.likes.toLocaleString()}</td>\n          <td>${item.shares.toLocaleString()}</td>\n          <td>${item.clicks.toLocaleString()}</td>\n          <td>${item.engagements.toLocaleString()}</td>\n          <td class=\"engagement-rate\">${item.engagementRate}</td>\n        </tr>\n      `).join('')}\n    </tbody>\n  </table>\n</body>\n</html>\n`;\n\n// Return formatted report\nreturn [{\n  json: {\n    summaryText,\n    csvData,\n    reportHtml,\n    totalStats: {\n      impressions: totalImpressions,\n      engagements: totalEngagements,\n      likes: totalLikes,\n      shares: totalShares,\n      clicks: totalClicks,\n      engagementRate: `${overallEngagementRate}%`\n    },\n    detailedData: performanceData\n  }\n}];"
      },
      "id": "b9ffcab8-3048-4ac2-ab3b-8edba6a47642",
      "name": "Format Performance Report",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1008,
        96
      ]
    },
    {
      "parameters": {
        "sendTo": "={{ $('Workflow Configuration').first().json.reportRecipientEmail }}",
        "subject": "={{ 'Marketing Campaign Performance Report - ' + $now.format('YYYY-MM-DD') }}",
        "message": "={{ $json.reportHtml }}",
        "options": {}
      },
      "id": "4055f7b6-b987-481e-abe8-0f7752581bdd",
      "name": "Send Report Email",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1408,
        368
      ],
      "webhookId": "32073eea-d2b8-47cb-b592-63c920dd7c04"
    },
    {
      "parameters": {
        "hasOutputParser": true,
        "options": {
          "systemMessage": "Tu es Thomas, expert marketing digital et cr\u00e9ation de contenu. Tu as acc\u00e8s \u00e0 l'historique de la conversation pour comprendre le contexte.\n\n\ud83d\udcdc HISTORIQUE DE LA CONVERSATION:\n{{ $json.body.history || \"D\u00e9but de conversation\" }}\n\n\ud83c\udfaf D\u00c9TECTION TYPE DE CONTENU:\n- \"g\u00e9n\u00e8re/cr\u00e9e une image de X\" \u2192 type_contenu: \"image\"\n- \"g\u00e9n\u00e8re/cr\u00e9e une vid\u00e9o de X\" \u2192 type_contenu: \"video\"  \n- \"post LinkedIn/Instagram/Twitter/Facebook\" \u2192 type_contenu: \"social_post\"\n- Questions/conversation \u2192 r\u00e9ponds normalement (pas de JSON)\n\n\u26a0\ufe0f R\u00c8GLES IMPORTANTES:\n1. UTILISE L'HISTORIQUE pour comprendre les r\u00e9f\u00e9rences\n2. Pour les POSTS SOCIAUX: g\u00e9n\u00e8re TOUJOURS texte + image ensemble\n3. Adapte le FORMAT selon le r\u00e9seau (LinkedIn=pro, Instagram=visuel, Twitter=court)\n4. Structure le texte en MARKDOWN\n\n\ud83d\udcf1 FORMATS PAR R\u00c9SEAU:\n\n**LinkedIn** (professionnel, 1300 caract\u00e8res max):\n- Accroche forte en premi\u00e8re ligne\n- Paragraphes courts avec sauts de ligne\n- Emojis professionnels mod\u00e9r\u00e9s\n- Call-to-action \u00e0 la fin\n- 5-10 hashtags en fin de post\n\n**Instagram** (visuel, 2200 caract\u00e8res max):\n- Premi\u00e8re ligne = hook accrocheur\n- Texte conversationnel et authentique\n- Emojis expressifs\n- Call-to-action engageant\n- 20-30 hashtags (s\u00e9par\u00e9s du texte)\n\n**Twitter/X** (concis, 280 caract\u00e8res):\n- Message percutant et direct\n- 1-2 hashtags int\u00e9gr\u00e9s\n- Peut inclure thread (plusieurs tweets)\n\n**Facebook** (storytelling, long format OK):\n- Ton personnel et engageant\n- Peut \u00eatre plus long\n- Questions pour engagement\n- 3-5 hashtags\n\n\ud83d\udce4 FORMAT JSON pour posts sociaux:\n{\n  \"type_contenu\": \"social_post\",\n  \"platform\": \"linkedin|instagram|twitter|facebook\",\n  \"post_content\": {\n    \"text\": \"Le texte du post en MARKDOWN avec **gras**, *italique*, etc.\",\n    \"hook\": \"L'accroche principale\",\n    \"cta\": \"Le call-to-action\"\n  },\n  \"hashtags\": [\"#tag1\", \"#tag2\"],\n  \"image_prompt\": \"Description d\u00e9taill\u00e9e pour g\u00e9n\u00e9rer l'image du post\",\n  \"generate_image\": true\n}\n\n\ud83d\udce4 FORMAT JSON pour images seules:\n{\n  \"type_contenu\": \"image\",\n  \"prompt_ameliore\": \"Description tr\u00e8s d\u00e9taill\u00e9e\",\n  \"description\": \"Texte court\",\n  \"hashtags\": [\"#tag1\", \"#tag2\"]\n}"
        }
      },
      "id": "fd2d9171-b082-4a17-999c-1ad1826b2de5",
      "name": "AI Agent: Generate Video Concept",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        -3680,
        2160
      ],
      "typeVersion": 1.9,
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash-001",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -3792,
        2416
      ],
      "id": "8fa170fd-f239-4f3a-9381-68ee1b6c9a4b",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "juqopekTUW4CU0nb",
          "name": "Google Gemini API"
        }
      }
    },
    {
      "parameters": {
        "description": "Utilise l\u2019outil pour r\u00e9fl\u00e9chir \u00e0 quelque chose.\nIl n\u2019obtiendra aucune nouvelle information et ne modifiera pas la base de donn\u00e9es, mais il ajoutera simplement la r\u00e9flexion au journal (log).\nUtilise-le lorsque un raisonnement complexe ou une m\u00e9moire temporaire est n\u00e9cessaire."
      },
      "id": "88c4ccee-9386-4a5b-a616-7b7ef72996b2",
      "name": "Tool: Inject Creativity",
      "type": "@n8n/n8n-nodes-langchain.toolThink",
      "position": [
        -3648,
        2416
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"type_contenu\": {\n      \"type\": \"string\",\n      \"enum\": [\"image\", \"video\", \"texte\", \"social_post\"],\n      \"description\": \"Type de contenu: image, video, texte ou social_post pour les r\u00e9seaux sociaux\"\n    },\n    \"platform\": {\n      \"type\": \"string\",\n      \"enum\": [\"linkedin\", \"instagram\", \"twitter\", \"facebook\"],\n      \"description\": \"Plateforme sociale (uniquement pour social_post)\"\n    },\n    \"post_content\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"text\": {\"type\": \"string\", \"description\": \"Texte du post en markdown\"},\n        \"hook\": {\"type\": \"string\", \"description\": \"Accroche principale\"},\n        \"cta\": {\"type\": \"string\", \"description\": \"Call-to-action\"}\n      },\n      \"description\": \"Contenu du post social (uniquement pour social_post)\"\n    },\n    \"prompt_ameliore\": {\n      \"type\": \"string\",\n      \"description\": \"Prompt enrichi pour image/video\"\n    },\n    \"image_prompt\": {\n      \"type\": \"string\",\n      \"description\": \"Prompt pour g\u00e9n\u00e9rer l'image du post social\"\n    },\n    \"generate_image\": {\n      \"type\": \"boolean\",\n      \"description\": \"True pour g\u00e9n\u00e9rer une image avec le post\"\n    },\n    \"description\": {\n      \"type\": \"string\",\n      \"description\": \"Courte description engageante\"\n    },\n    \"hashtags\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Liste des hashtags\"\n    },\n    \"keywords\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Mots-cl\u00e9s principaux\"\n    }\n  },\n  \"required\": [\"type_contenu\"]\n}"
      },
      "id": "42e7f6c3-a90d-4380-83ce-76062c6cf7e3",
      "name": "Parser: Extract JSON from Idea",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "position": [
        -3504,
        2416
      ],
      "typeVersion": 1.2,
      "disabled": false
    },
    {
      "parameters": {
        "public": true,
        "mode": "webhook",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.4,
      "position": [
        -4016,
        2160
      ],
      "id": "3fabed4a-1ead-44a5-877e-dd7c7486b3c5",
      "name": "When chat message received",
      "webhookId": "4bd6ad35-7ef0-43af-9a78-d14e818abb10"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.openai.com/v1/images/generations",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "openAiApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"dall-e-3\",\n  \"prompt\": \"={{ $json.output.prompt_ameliore }}\",\n  \"n\": 1,\n  \"size\": \"1024x1024\"\n}",
        "options": {}
      },
      "id": "60788212-ab1c-4d75-8e2e-84c3f2c696cc",
      "name": "Generate Image - DALL-E API1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -4976,
        2096
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": false,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0f0569f3-e925-4d99-85e4-99ff8603ef76",
              "leftValue": "={{ $json.output.type_contenu }}",
              "rightValue": "video",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {
          "ignoreCase": true
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2928,
        2160
      ],
      "id": "056c2dbb-c589-42c8-a941-4fec97449feb",
      "name": "if type : vid\u00e9os"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": false,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0f0569f3-e925-4d99-85e4-99ff8603ef76",
              "leftValue": "={{ $json.output.type_contenu }}",
              "rightValue": "image",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {
          "ignoreCase": true
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2928,
        1584
      ],
      "id": "10a6fac9-6430-4725-8389-0ffe4b8b2df3",
      "name": "if type : image"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": false,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "0f0569f3-e925-4d99-85e4-99ff8603ef76",
              "leftValue": "={{ $json.output.type_contenu }}",
              "rightValue": "Texte",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {
          "ignoreCase": true
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2896,
        2752
      ],
      "id": "857fc6f9-744a-418a-a669-bede883be5fd",
      "name": "if type : text"
    },
    {
      "parameters": {
        "content": "Noeuds reutilisables probablement apr\u00e9s\n\n",
        "height": 768,
        "width": 960
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -5520,
        1920
      ],
      "typeVersion": 1,
      "id": "2ebc45b8-0e1e-4006-9033-037676ce00f3",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash-image-preview",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash-image-preview (Nano Banana)"
        },
        "prompt": "=Prompt : {{ $json.output.prompt_ameliore }}\nDescription : {{ $json.output.description }}",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        -5200,
        1952
      ],
      "id": "f214987c-7f73-461c-b645-c0fcafe3a035",
      "name": "Generate an image",
      "credentials": {
        "googlePalmApi": {
          "id": "juqopekTUW4CU0nb",
          "name": "Google Gemini API"
        }
      }
    },
    {
      "parameters": {
        "amount": 2
      },
      "id": "46a7ef24-362e-41d2-833a-b05b62306a34",
      "name": "Attendre le traitement",
      "type": "n8n-nodes-base.wait",
      "position": [
        -4784,
        1936
      ],
      "webhookId": "be68de57-846b-4b9d-9bc4-7fd68016e9f5",
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api-inference.huggingface.co/models/black-forest-labs/FLUX.1-schnell",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {}
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"inputs\": \"={{ $json.output.prompt_ameliore }}\",\n  \"parameters\": {\n    \"num_inference_steps\": 4,\n    \"guidance_scale\": 0\n  }\n}",
        "options": {
          "lowercaseHeaders": false
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -5456,
        2144
      ],
      "id": "efc11f85-e52c-4f3f-97f3-d1e2111e64e0",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash-image-preview",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash-image-preview (Nano Banana)"
        },
        "prompt": "={{ $json.output.description }}\n\n{{ $json.output.prompt_ameliore }}\n",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        -5168,
        2224
      ],
      "id": "5a5843ed-3836-4f27-bf37-3c30189b1d54",
      "name": "Generate an image2",
      "credentials": {
        "googlePalmApi": {
          "id": "juqopekTUW4CU0nb",
          "name": "Google Gemini API"
        }
      }
    },
    {
      "parameters": {
        "resource": "image",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 2,
      "position": [
        -5456,
        2352
      ],
      "id": "acca2919-6339-4bfe-b1ba-271e625a3334",
      "name": "Generate an image1"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -2576,
        2464
      ],
      "id": "70bd47c7-76a7-4398-acca-23ffc1d333d3",
      "name": "OpenAI Chat Model",
      "disabled": true
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Give me a Veo3 prompt for this idea:\n{{ $json.output[0].Idea }}\n\nThis is the environment:\n{{ $json.output[0].Environment }}\n\nL\u00e9gende:\n{{ $json.output[0].Caption }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=SYSTEM PROMPT FOR GOOGLE VEO3 PROMPT AGENT\n\nYou are an AI agent that writes hyper-realistic, cinematic video prompts for Google VEO3. Each prompt should describe a short, vivid selfie-style video clip featuring one unnamed character speaking or acting in a specific moment. The final video should look like found footage or documentary-style film \u2014 grounded, realistic, and immersive.\n\nREQUIRED STRUCTURE (FILL IN THE BRACKETS BELOW):\n\n[Scene paragraph prompt here]\n\nMain character: [description of character]\nThey say: [insert one line of dialogue, fits the scene and mood].\nThey [describe a physical action or subtle camera movement, e.g. pans the camera, shifts position, glances around].\nTime of Day: [day / night / dusk / etc.]\nLens: [describe lens]\nAudio: (implied) [ambient sounds, e.g. lion growls, wind, distant traffic, birdsong]\nBackground: [brief restatement of what is visible behind them]\n\nRULES FOR PROMPT GENERATION\n\nSingle paragraph only, 750\u20131500 characters. No line breaks or headings.\n\nOnly one human character. Never give them a name.\n\nInclude one spoken line of dialogue and describe how it\u2019s delivered.\n\nCharacter must do something physical, even if subtle (e.g. glance, smirk, pan camera).\n\nUse selfie-style framing. Always describe the lens, stock, and camera behavior.\n\nScene must feel real and cinematic \u2014 like a short clip someone might record on a stylized camera.\n\nAlways include the five key technical elements: Time of Day, Lens, Film Stock, Audio, and Background.\n\nDO NOT DO THIS:\n\nDon\u2019t name the character.\n\nDon\u2019t include more than one character.\n\nDon\u2019t describe subtitles or on-screen text.\n\nDon\u2019t break the paragraph or use formatting.\n\nDon\u2019t write vague or abstract scenes \u2014 always keep them grounded in physical detail."
        }
      },
      "id": "be38c9f2-3447-4c65-a55a-9219f6fcf845",
      "name": "AI Agent: Create Veo3-Compatible Prompt",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        -2224,
        2144
      ],
      "typeVersion": 1.9
    },
    {
      "parameters": {},
      "id": "7b306327-cb21-45b1-90c7-ea889524c2c7",
      "name": "Tool: Build Prompt Structure",
      "type": "@n8n/n8n-nodes-langchain.toolThink",
      "position": [
        -2400,
        2464
      ],
      "typeVersion": 1,
      "disabled": true
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
      "typeVersion": 1,
      "position": [
        -2048,
        2352
      ],
      "id": "d780053f-b9fb-444b-a8c0-e4db153d60dd",
      "name": "Auto-fixing Output Parser",
      "disabled": true
    },
    {
      "parameters": {
        "content": "# \u2705 STEP 4 \u2014 Cr\u00e9ation de vid\u00e9os avec Veo3\n\nGoogle Sheets: Save Script Idea [Videos] \u2192 enregistre le script vid\u00e9o dans Sheets.\n\nAI Agent: Create Veo3 Video \u2192 envoie les instructions ( id\u00e9e, description...  ) \u00e0 Veo3 pour cr\u00e9er la vid\u00e9o.\n\nAuto-fixing Output Parser \u2192 corrige automatiquement la sortie si n\u00e9cessaire.",
        "height": 280,
        "width": 1024,
        "color": 3
      },
      "id": "021eab22-8e97-46ac-bdb1-7d47c8c142e5",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1440,
        2320
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://queue.fal.run/fal-ai/veo3",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={ \"prompt\": \"{{ $json.output }}\" }\n",
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 2000
            }
          }
        }
      },
      "id": "79d23449-d1c0-4a87-9eef-b63de056cdb2",
      "name": "Call Veo3 API to Generate Video",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -1248,
        2144
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {},
      "id": "b486f193-0ba7-433c-a448-c4a586e99ddf",
      "name": "Wait for Veo3 Processing (5 mins)",
      "type": "n8n-nodes-base.wait",
      "position": [
        -1104,
        2144
      ],
      "webhookId": "54182766-d739-439e-9bc7-fdb72ea73bb3",
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "url": "=https://queue.fal.run/fal-ai/veo3/requests/{{ $json.request_id }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {}
      },
      "id": "82a6c2c7-2406-46b6-9b66-5f0329f9e0d5",
      "name": "Retrieve Final Video URL from Veo3",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -896,
        2144
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
          "mode": "url"
        },
        "columns": {
          "value": {
            "idea": "={{ $('Google Sheets: Save Script Idea [ Vid\u00e9os]').first().json.idea }}",
            "production": "done",
            "final_output": "={{ $json.video.url }}"
          },
          "schema": [
            {
              "id": "id",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "id",
              "defaultMatch": true,
              "canBeUsedToMatch": true
            },
            {
              "id": "idea",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "idea",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "caption",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "caption",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "production",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "production",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "environment_prompt",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "environment_prompt",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "final_output",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "final_output",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "type": "string",
              "display": true,
              "removed": true,
              "readOnly": true,
              "required": false,
              "displayName": "row_number",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "idea"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "d2e1dee2-cbae-46be-8401-5cd72f645c17",
      "name": "Google Sheets: Log Final Video Output",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        -720,
        2144
      ],
      "typeVersion": 4.5,
      "disabled": true
    },
    {
      "parameters": {
        "content": "## Bloc principal ",
        "height": 948,
        "width": 1120
      },
      "id": "a5ec77ae-2377-440e-9178-9e2b87b5a9e8",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -4272,
        1984
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -2224,
        2480
      ],
      "id": "8464c7f0-e8af-4b23-9b48-8f77810c64f7",
      "name": "OpenAI Chat Model1",
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "dce86315-88a5-4589-a0e9-41efc07b0748",
              "name": "URL IMAGE",
              "value": "={{ $json.data[0].url }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1760,
        1232
      ],
      "id": "2fc65aa7-7e6b-4a87-aa40-f1caf79c38f4",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Image",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Prompt am\u00e9liorer": "={{ $json.output.prompt_ameliore }}",
            "Description": "={{ $json.output.description }}",
            "Hashtags": "={{ $json.output.hashtags }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Prompt am\u00e9liorer",
              "displayName": "Prompt am\u00e9liorer",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Description",
              "displayName": "Description",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Hashtags",
              "displayName": "Hashtags",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "URL IMAGE",
              "displayName": "URL IMAGE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "c4bc1e75-9da4-4eda-9463-370383456a66",
      "name": "Google Sheets: Save Script Idea [ Image ]",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        -2576,
        1232
      ],
      "typeVersion": 4.5,
      "disabled": true
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1169278069,
          "mode": "list",
          "cachedResultName": "Vid\u00e9os",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit#gid=1169278069"
        },
        "columns": {
          "value": {
            "id": "==ROW()-1",
            "idea": "={{ $json.output[0].Idea }}",
            "caption": "={{ $json.output[0].Caption }}",
            "production": "={{ $json.output[0].Status }}",
            "environment_prompt": "={{ $json.output[0].Environment }}"
          },
          "schema": [
            {
              "id": "id",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "id",
              "defaultMatch": true,
              "canBeUsedToMatch": true
            },
            {
              "id": "idea",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "idea",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "caption",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "caption",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "production",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "production",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "environment_prompt",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "environment_prompt",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "final_output",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "final_output",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "id"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "54e8c71c-a3ba-4f66-8fd2-db5419114a58",
      "name": "Google Sheets: Save Script Idea [ Vid\u00e9os]",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        -2560,
        2144
      ],
      "typeVersion": 4.5,
      "disabled": true
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Image",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "URL IMAGE": "={{ $json['URL IMAGE'] }}",
            "Prompt am\u00e9liorer": "="
          },
          "matchingColumns": [
            "URL IMAGE"
          ],
          "schema": [
            {
              "id": "Prompt am\u00e9liorer",
              "displayName": "Prompt am\u00e9liorer",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Description",
              "displayName": "Description",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Hashtags",
              "displayName": "Hashtags",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "URL IMAGE",
              "displayName": "URL IMAGE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "3753f58d-77aa-49a1-9130-5c87e0bd69f8",
      "name": "Google Sheets: Save Script Idea [ Image ] With URL",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        -1536,
        1232
      ],
      "typeVersion": 4.5,
      "disabled": true
    },
    {
      "parameters": {
        "model": "google/gemini-2.0-flash-001",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        -2208,
        3008
      ],
      "id": "b3bbea9b-346e-4d72-b7f2-fcdd71f325de",
      "name": "OpenRouter Chat Model",
      "disabled": true
    },
    {
      "parameters": {
        "operation": "classify",
        "options": {}
      },
      "id": "150d3518-eacb-486a-ad60-187b38f9c3c5",
      "name": "Generate Text Content [ sasn Agent IA ]",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 2,
      "position": [
        -5456,
        1984
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=R\u00f4le de l\u2019Agent\n\nTu es un r\u00e9dacteur expert en communication digitale, sp\u00e9cialis\u00e9 dans la cr\u00e9ation de contenus performants pour les r\u00e9seaux sociaux (LinkedIn, Instagram, X, Facebook, etc.).\n\nTon objectif est de produire un contenu impactant, humain, naturel et engageant, optimis\u00e9 pour la lecture sur mobile et fid\u00e8le au ton demand\u00e9.\nLe texte doit donner l\u2019impression claire qu\u2019il a \u00e9t\u00e9 r\u00e9dig\u00e9 par un humain, et non par une machine.\n\nDonn\u00e9es d\u2019entr\u00e9e\n\nTu recevras un objet JSON pouvant contenir les champs suivants (ils peuvent \u00eatre pr\u00e9sents ou absents) :\n\n{{ $json.output.prompt_ameliore }}\n\n{{ $json.output.description }}\n\nle ton (si pr\u00e9sent)\n\nLes \u00e9mojies (oui / true / autoris\u00e9 / non) ( si l'utilisateur \u00e0 pr\u00e9ciser ).\n\nTa mission\n\n\u00c0 partir des donn\u00e9es fournies, tu dois :\n\nComprendre le sujet principal du post.\n\nIdentifier ou d\u00e9duire le ton \u00e0 adopter :\n\nhumoristique professionnel\n\ns\u00e9rieux\n\ninspirant\n\n\u00e9ducatif\n\nprovocateur\n\ninformatif\n\nAm\u00e9liorer et enrichir le contenu :\n\nrendre le message plus clair\n\nrenforcer l\u2019impact\n\nam\u00e9liorer le rythme\n\nsupprimer toute lourdeur ou r\u00e9p\u00e9tition\n\nOptimiser le texte pour les r\u00e9seaux sociaux :\n\nphrases courtes\n\nstructure a\u00e9r\u00e9e\n\nstyle fluide et naturel\n\npunchlines si le ton le permet\n\nG\u00e9n\u00e9rer des hashtags optimis\u00e9s :\n\nmaximum 10\n\npertinents et li\u00e9s au sujet\n\nsans doublons\n\nadapt\u00e9s aux tendances du domaine\n\n\ud83c\udfa8 Gestion des \u00e9mojis (r\u00e8gles strictes)\n\nTu peux int\u00e9grer des \u00e9mojis uniquement si au moins une des conditions suivantes est remplie :\n\nl\u2019utilisateur le demande explicitement\n\nemojis vaut \"oui\", \"true\" ou \"autoris\u00e9\"\n\nle ton s\u2019y pr\u00eate naturellement (inspirant, dynamique, humoristique)\nsi tu pense que le mettre serais un plus ... et donnerais plsu de clart\u00e9 .. de visibilit\u00e9 .. d'humour\n\n\u26a0\ufe0f Interdictions :\n\nNe jamais forcer des \u00e9mojis\n\nPas d\u2019exc\u00e8s : les \u00e9mojis doivent rester discrets et utiles",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=R\u00f4le de l\u2019Agent\n\nTu es un r\u00e9dacteur expert en communication digitale, sp\u00e9cialis\u00e9 dans la cr\u00e9ation de contenus performants pour les r\u00e9seaux sociaux (LinkedIn, Instagram, X, Facebook, etc.).\n\nTon objectif est de produire un contenu impactant, humain, naturel et engageant, optimis\u00e9 pour la lecture sur mobile et fid\u00e8le au ton demand\u00e9.\nLe texte doit donner l\u2019impression claire qu\u2019il a \u00e9t\u00e9 r\u00e9dig\u00e9 par un humain, et non par une machine.\n\nDonn\u00e9es d\u2019entr\u00e9e\n\nTu recevras un objet JSON pouvant contenir les champs suivants (ils peuvent \u00eatre pr\u00e9sents ou absents) :\n\n{{ $json.output.prompt_ameliore }}\n\n{{ $json.output.description }}\n\nle ton (si pr\u00e9sent)\n\nLes \u00e9mojies (oui / true / autoris\u00e9 / non) ( si l'utilisateur \u00e0 pr\u00e9ciser ).\n\nTu dois t\u2019adapter automatiquement aux informations disponibles.\n\nTa mission\n\n\u00c0 partir des donn\u00e9es fournies, tu dois :\n\nComprendre le sujet principal du post.\n\nIdentifier ou d\u00e9duire le ton \u00e0 adopter :\n\nhumoristique professionnel\n\ns\u00e9rieux\n\ninspirant\n\n\u00e9ducatif\n\nprovocateur\n\ninformatif\n\nAm\u00e9liorer et enrichir le contenu :\n\nrendre le message plus clair\n\nrenforcer l\u2019impact\n\nam\u00e9liorer le rythme\n\nsupprimer toute lourdeur ou r\u00e9p\u00e9tition\n\nOptimiser le texte pour les r\u00e9seaux sociaux :\n\nphrases courtes\n\nstructure a\u00e9r\u00e9e\n\nstyle fluide et naturel\n\npunchlines si le ton le permet\n\nG\u00e9n\u00e9rer des hashtags optimis\u00e9s :\n\nmaximum 10\n\npertinents et li\u00e9s au sujet\n\nsans doublons\n\nadapt\u00e9s aux tendances du domaine\n\n\ud83c\udfa8 Gestion des \u00e9mojis (r\u00e8gles strictes)\n\nTu peux int\u00e9grer des \u00e9mojis uniquement si au moins une des conditions suivantes est remplie :\n\nl\u2019utilisateur le demande explicitement\n\n$json.emojis vaut \"oui\", \"true\" ou \"autoris\u00e9\"\n\nle ton s\u2019y pr\u00eate naturellement (inspirant, dynamique, humoristique)\n\n\u26a0\ufe0f Interdictions :\n\nNe jamais forcer des \u00e9mojis\n\nAucun emoji dans un contenu s\u00e9rieux, institutionnel ou formel\n\nPas d\u2019exc\u00e8s : les \u00e9mojis doivent rester discrets et utiles\n\n\ud83d\udce4 FORMAT DE SORTIE \u2014 OBLIGATOIRE\n\nTu dois TOUJOURS r\u00e9pondre avec exactement ces 4 champs, dans cet ordre, sans texte suppl\u00e9mentaire :\n\n{\n  \"sujet\": \"Sujet principal du post\"},\n  {\"ton_utilise\": \"Ton r\u00e9ellement utilis\u00e9 pour la r\u00e9daction\"},\n  {\"texte_genere\": \"Texte final du post, optimis\u00e9 pour les r\u00e9seaux sociaux, SANS hashtags\"},\n  {\"hashtags\": [\n    \"#hashtag1\",\n    \"#hashtag2\",\n    \"#hashtag3\",\n    \"#hashtag4\"\n  ]},\n  {\"emojis_utilises\": [\n    \"\ud83d\ude00\",\n    \"\ud83d\ude80\",\n    \"\u2728\"\n  ]\n}\n\n\n\u26a0\ufe0f Contraintes finales\n\nToujours r\u00e9pondre en fran\u00e7ais, sauf demande explicite contraire.\n\nLe texte doit \u00eatre cr\u00e9dible, humain et naturel.\n\nNe jamais mentionner le prompt, les r\u00e8gles ou le format dans la r\u00e9ponse finale.\n\nRespecter strictement le format JSON demand\u00e9."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -1904,
        2736
      ],
      "id": "d6a8b0a9-8c33-434e-9d7c-659874bbff6b",
      "name": "Generate Text Content"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 39238683,
          "mode": "list",
          "cachedResultName": "Texte",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit#gid=39238683"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {},
          "matchingColumns": [],
          "schema": [
            {
              "id": "Sujet",
              "displayName": "Sujet",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Ton",
              "displayName": "Ton",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Texte Genere",
              "displayName": "Texte Genere",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Hashtags",
              "displayName": "Hashtags",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Emojis utilise",
              "displayName": "Emojis utilise",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "output",
              "displayName": "output",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "b04f2379-4829-4599-8675-3ad18cfba0f3",
      "name": "Google Sheets: Save Script Idea [ Texte ]",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        -2272,
        2736
      ],
      "typeVersion": 4.5,
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "477bb414-ab23-464d-ab06-32f9bc03b861",
              "name": "Sujet",
              "value": "={{ $json.output.sujet }}",
              "type": "string"
            },
            {
              "id": "c628093c-c1e9-4726-8266-0beee98f2936",
              "name": "Ton",
              "value": "={{ $json.output.ton_utilise }}",
              "type": "string"
            },
            {
              "id": "72536cbf-405e-4e14-978a-c47131c8e35b",
              "name": "Texte g\u00e9n\u00e9r\u00e9 ",
              "value": "={{ $json.output.texte_genere }}",
              "type": "string"
            },
            {
              "id": "a2019d21-53bc-4f9d-9325-67ef38c461dc",
              "name": "Emojis utilis\u00e9s",
              "value": "={{ $json.output.emojis_utilises }}",
              "type": "string"
            },
            {
              "id": "d96df29c-b9dc-40d4-8e1e-50685a95d08e",
              "name": "Hashtags",
              "value": "={{ $json.output.hashtags }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1472,
        2736
      ],
      "id": "40ed0a55-9dbb-4154-b91b-7cfc6c780fb4",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 39238683,
          "mode": "list",
          "cachedResultName": "Texte",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit#gid=39238683"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {},
          "matchingColumns": [
            "idea"
          ],
          "schema": [
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "19c4cd9a-e73c-49a9-8aff-904343f7f92e",
      "name": "Google Sheets: Log Final Texte Output",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        -1152,
        2736
      ],
      "typeVersion": 4.5,
      "disabled": true
    },
    {
      "parameters": {
        "content": "##  \u2705 STEP 2 --- Identification du type de demande\n",
        "height": 1616,
        "width": 400,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -3104,
        1456
      ],
      "typeVersion": 1,
      "id": "8ef7be3c-b086-43b9-b105-010b669459ea",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "## \u201cif type: image\u201d",
        "height": 912,
        "width": 1392,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2656,
        1088
      ],
      "typeVersion": 1,
      "id": "57e9626d-0d88-4958-8fe7-0972cc42f878",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "## Branche \u201cif type: videos\u201d\n\n",
        "height": 576,
        "width": 2112,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2640,
        2032
      ],
      "typeVersion": 1,
      "id": "ec5421b8-2955-4be5-9e5b-ccf645b4dc5a",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "content": "## \u2705 STEP 3 \u2014 Cr\u00e9ation d'image avec DALL-E\nGoogle Sheets: Save Script Idea [Image] \u2192 sauvegarde l\u2019id\u00e9e d\u2019image dans une feuille Google.\n\nGenerate Image - DALL\u00b7E API \u2192 cr\u00e9e l\u2019image via DALL\u00b7E selon le script g\u00e9n\u00e9r\u00e9.\n\nEdit Fields (manual) \u2192 permet d\u2019\u00e9diter les r\u00e9sultats manuellement si n\u00e9cessaire.\n\nGoogle Sheets: Save Script Idea [Image] W/... \u2192 enregistre le r\u00e9sultat final dans la feuille.",
        "height": 208,
        "width": 880,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2176,
        1776
      ],
      "typeVersion": 1,
      "id": "11bea10b-cac7-47bf-ac10-4fd97e84d7d9",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "content": "## Branche \u201cif type: text\u201d\n\n",
        "height": 672,
        "width": 1856,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2640,
        2672
      ],
      "typeVersion": 1,
      "id": "f1b285cc-430f-42a2-a2ea-8bf47e07516b",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "content": "# \u2705 STEP 5 \u2014 Cr\u00e9ation de Texte\n\nGoogle Sheets: Save Script Idea [Text] \u2192 sauvegarde l\u2019id\u00e9e texte.\n\nGenerate Text Content \u2192 g\u00e9n\u00e8re le contenu complet via OpenRouter Chat Model et Perplexity (pour compl\u00e9ter ou am\u00e9liorer).\n\nEdit Fields1 (manual) \u2192 possibilit\u00e9 de correction manuelle.\n\nGoogle Sheets: Log Final Texte Output \u2192 enregistre le texte final. ",
        "height": 280,
        "width": 1024
      },
      "id": "c6f953cc-e7c3-4598-a837-f460489f55e1",
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1616,
        2992
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## \u2705 STEP 1 \u2014 G\u00e9n\u00e9ration du  Script & Prompt avec l'IA\n\nEntr\u00e9e : \u201cWhen chat message received\u201d \u2192 d\u00e9clenche le workflow lorsqu\u2019un message arrive.\n\nMod\u00e8le utilis\u00e9 : Google Gemini Chat Model\n\nOutils :\n\nTool Inject Creativity \u2192 pour enrichir et varier les id\u00e9es.\n\nParser: Extract JSON from Idea \u2192 transforme l\u2019id\u00e9e en format structur\u00e9 JSON.\n\nFonction : G\u00e9n\u00e8re un script ou un concept bas\u00e9 sur l\u2019entr\u00e9e utilisateur.\n\nSortie : Dirig\u00e9e selon le type (image, video, text) vers les blocs correspondants pour traitement.",
        "height": 464,
        "width": 1088
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -4448,
        2560
      ],
      "typeVersion": 1,
      "id": "29298a20-b3c7-4858-b29b-bfd06ecf5b5e",
      "name": "Sticky Note9"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "{\n  \"instagram_id\": \"1111\",\n  \"youtube_id\": \"1111\",\n  \"threads_id\": \"1111\",\n  \"tiktok_id\": \"1111\",\n  \"facebook_id\": \"1111\",\n  \"facebook_page_id\": \"1111\",\n  \"twitter_id\": \"1111\",\n  \"linkedin_id\": \"1111\",\n  \"pinterest_id\": \"1111\",\n  \"pinterest_board_id\": \"1111\",\n  \"bluesky_id\": \"1111\"\n}\n",
        "options": {}
      },
      "id": "c5e766a2-dcd9-491f-8eb2-2d4dee96c694",
      "name": "Assign Social Media IDs",
      "type": "n8n-nodes-base.set",
      "position": [
        0,
        2176
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit#gid=0"
        },
        "options": {}
      },
      "id": "3bbf8803-1404-478f-926f-92941256bcb1",
      "name": "Get my video",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        96,
        1904
      ],
      "typeVersion": 4.5
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://backend.blotato.com/v2/media",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "blotato-api-key",
              "value": "YOUR_API_HERE"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "url",
              "value": "={{ $('Get my video').item.json['final_output'] }}"
            }
          ]
        },
        "options": {}
      },
      "id": "042beea3-57d6-4cab-bf0b-107b3b1b23e2",
      "name": "Upload Video to Blotato",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        224,
        2176
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://backend.blotato.com/v2/posts",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "blotato-api-key",
              "value": "YOUR_API_HERE"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.instagram_id }}\",\n    \"target\": {\n      \"targetType\": \"instagram\"\n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"instagram\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n\n",
        "options": {}
      },
      "id": "3b7c6b62-8798-4ebf-9507-7482d20b9447",
      "name": "INSTAGRAM",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        496,
        1904
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://backend.blotato.com/v2/posts",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "blotato-api-key",
              "value": "YOUR_API_HERE"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.youtube_id }}\",\n    \"target\": {\n      \"targetType\": \"youtube\",\n      \"title\": \"{{ $('Get my video').item.json.Titre }}\",\n      \"privacyStatus\": \"unlisted\",\n      \"shouldNotifySubscribers\": \"false\"\n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"youtube\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
        "options": {}
      },
      "id": "c2ad37c7-0678-44bd-8dff-9622d1f56be5",
      "name": "YOUTUBE",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        720,
        1904
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://backend.blotato.com/v2/posts",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "blotato-api-key",
              "value": "=YOUR_API_HERE"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.tiktok_id }}\",\n    \"target\": {\n      \"targetType\": \"tiktok\",\n      \"isYourBrand\": \"false\", \n      \"disabledDuet\": \"false\",\n      \"privacyLevel\": \"PUBLIC_TO_EVERYONE\",\n      \"isAiGenerated\": \"true\",\n      \"disabledStitch\": \"false\",\n      \"disabledComments\": \"false\",\n      \"isBrandedContent\": \"false\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"tiktok\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
        "options": {}
      },
      "id": "333043c2-7ec0-41b1-b7e5-881961caaa8c",
      "name": "TIKTOK",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1120,
        1904
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://backend.blotato.com/v2/posts",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "blotato-api-key",
              "value": "=YOUR_API_HERE"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.facebook_id }}\",\n    \"target\": {\n      \"targetType\": \"facebook\",\n      \"pageId\": \"{{ $('Assign Social Media IDs').item.json.facebook_page_id }}\"\n\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"facebook\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}",
        "options": {}
      },
      "id": "235f4d51-51c8-428c-9e05-aa81be863ea4",
      "name": "FACEBOOK",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        496,
        2176
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://backend.blotato.com/v2/posts",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "blotato-api-key",
              "value": "YOUR_API_HERE"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.threads_id }}\",\n    \"target\": {\n      \"targetType\": \"threads\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"threads\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
        "options": {}
      },
      "id": "3055cde0-a74f-4770-b1b2-441b5a670234",
      "name": "THREADS",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        720,
        2176
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://backend.blotato.com/v2/posts",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "blotato-api-key",
              "value": "YOUR_API_HERE"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.twitter_id }}\",\n    \"target\": {\n      \"targetType\": \"twitter\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"twitter\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
        "options": {}
      },
      "id": "94af5d65-d6ea-4c45-b629-78262f232a03",
      "name": "TWETTER",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1120,
        2176
      ],
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://backend.blotato.com/v2/posts",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "blotato-api-key",
              "value": "YOUR_API_HERE"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.linkedin_id }}\",\n    \"target\": {\n      \"targetType\": \"linkedin\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"linkedin\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
        "options": {}
      },
      "id": "ab65f27f-84e2-4c6c-abea-adefa5fa6549",
      "name": "LINKEDIN",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        496,
        2416
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://backend.blotato.com/v2/posts",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "blotato-api-key",
              "value": "YOUR_API_HERE"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "= {\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.bluesky_id }}\",\n    \"target\": {\n      \"targetType\": \"bluesky\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"bluesky\",\n      \"mediaUrls\": [\n        \"https://pbs.twimg.com/media/GE8MgIiWEAAfsK3.jpg\"\n      ]\n    }\n  }\n}\n",
        "options": {}
      },
      "id": "56498096-c214-42ec-913d-22b4544bc1b1",
      "name": "BLUESKY",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        720,
        2416
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://backend.blotato.com/v2/posts",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "blotato-api-key",
              "value": "YOUR_API_HERE"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.pinterest_id }}\",\n    \"target\": {\n      \"targetType\": \"pinterest\",\n      \"boardId\": \"{{ $('Assign Social Media IDs').item.json.pinterest_board_id }}\"      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"pinterest\",\n      \"mediaUrls\": [\n        \"https://pbs.twimg.com/media/GE8MgIiWEAAfsK3.jpg\"\n      ]\n    }\n  }\n}\n\n",
        "options": {}
      },
      "id": "6fe4a662-8539-4400-b485-23e8852ffc7c",
      "name": "PINTEREST",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1120,
        2416
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "mode": "url",
          "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
          "__regex": "https:\\/\\/(?:drive|docs)\\.google\\.com(?:\\/.*|)\\/d\\/([0-9a-zA-Z\\-_]+)(?:\\/.*|)"
        },
        "sheetName": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
          "mode": "url"
        },
        "columns": {
          "value": {
            "STATUS": "Publish",
            "row_number": "={{ $('Get my video').item.json.row_number }}"
          },
          "schema": [
            {
              "id": "PROMPT",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "PROMPT",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "DESCRIPTION",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "DESCRIPTION",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "URL VIDEO",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "URL VIDEO",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Titre",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Titre",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "STATUS",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "STATUS",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": true,
              "required": false,
              "displayName": "row_number",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "row_number"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "id": "d47c9164-5755-474d-b6b7-293689c3f03b",
      "name": "Google Sheets",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        224,
        2416
      ],
      "typeVersion": 4.5,
      "disabled": true
    },
    {
      "parameters": {
        "content": "# \u2705 STEP 3 \u2014 Publish Video to Social Media\n",
        "height": 760,
        "width": 1200,
        "color": 4
      },
      "id": "6ade3588-a66c-4d1e-9596-2eb30740f757",
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -128,
        1808
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "url": "={{ $json.data[0].url }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -2688,
        736
      ],
      "id": "7d7abbef-08c2-40f2-bb87-c73bcec05288",
      "name": "HTTP Request1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.infip.pro/v1/images/generations",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={\n  \"model\": \"img3\",\n  \"prompt\": \"Un assistant IA professionnel travaillant sur une interface futuriste, style corporate, fond clair\",\n  \"n\": 1,\n  \"size\": \"1024x1024\"\n}\n",
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 2000
            }
          }
        }
      },
      "id": "ef9e73ae-0e6c-46c9-808d-37a353d16ab2",
      "name": "Call image with Ghostbot web",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -2912,
        736
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.infip.pro/v1/images/generations",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={\n  \"model\": \"img3\",\n  \"prompt\": \"{{ $json.output.prompt_ameliore }}\",\n  \"n\": 1,\n  \"size\": \"1024x1024\"\n}\n",
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 2000
            }
          }
        }
      },
      "id": "daa73726-b6e2-4f7e-8b56-f8ac3b911675",
      "name": "Call image with Ghostbot web1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -2288,
        1232
      ],
      "typeVersion": 4.2,
      "disabled": true
    },
    {
      "parameters": {
        "url": "={{ $json.data[0].url }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -2032,
        1232
      ],
      "id": "0d77d702-237d-424b-b77f-e21ce4b64cab",
      "name": "HTTP Request2"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -4016,
        2416
      ],
      "id": "c5fcb121-2ffb-4341-a1d4-b6d5507a6dbe",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "juqopekTUW4CU0nb",
          "name": "Google Gemini API"
        }
      }
    },
    {
      "parameters": {
        "url": "={{ $json.choices[0].message.images[0].image_url.url }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -3280,
        720
      ],
      "id": "49d970ce-4bad-4fb8-9c3f-70f3ce4587b8",
      "name": "HTTP Request3",
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://openrouter.ai/api/v1/chat/completions",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "openRouterApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n    \"model\": \"google/gemini-2.5-flash-image-preview\",\n    \"messages\": [\n      {\n        \"role\": \"user\",\n        \"content\": [\n          {\n            \"type\": \"text\",\n            \"text\": \"genere moi une image de chat qui dort\"\n          }\n        ]\n      }\n    ]\n  }",
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 2000
            }
          }
        }
      },
      "id": "b1dfea58-9760-4f11-9e89-6bf12cec9bce",
      "name": "nano  banana",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -3472,
        720
      ],
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://openrouter.ai/api/v1/chat/completions",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "openRouterApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "\n\n{\n  \"model\": \"google/gemini-2.0-flash-001\",\n  \"messages\": [\n      {\n        \"role\": \"user\",\n        \"content\": [\n          {\n            \"type\": \"text\",\n            \"text\": \"THEME, LES AMIES, arguemnte l\u00e0-dessus\"\n          }\n        ]\n    \n      }\n  ]\n}",
        "options": {}
      },
      "id": "b5690ccd-bfe4-4ad3-ba21-c2e071e1c6df",
      "name": "nano  banana1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -3824,
        736
      ],
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "messages": {
          "message": [
            {}
          ]
        },
        "options": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.perplexityTool",
      "typeVersion": 1,
      "position": [
        -1760,
        3008
      ],
      "id": "3c24fefa-df38-465b-aafa-2b236c309d88",
      "name": "Message a model in Perplexity",
      "disabled": true
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"type_contenu\": {\n      \"type\": \"string\",\n      \"enum\": [\"image\", \"video\", \"texte\", \"social_post\"],\n      \"description\": \"Type de contenu: image, video, texte ou social_post pour les r\u00e9seaux sociaux\"\n    },\n    \"platform\": {\n      \"type\": \"string\",\n      \"enum\": [\"linkedin\", \"instagram\", \"twitter\", \"facebook\"],\n      \"description\": \"Plateforme sociale (uniquement pour social_post)\"\n    },\n    \"post_content\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"text\": {\"type\": \"string\", \"description\": \"Texte du post en markdown\"},\n        \"hook\": {\"type\": \"string\", \"description\": \"Accroche principale\"},\n        \"cta\": {\"type\": \"string\", \"description\": \"Call-to-action\"}\n      },\n      \"description\": \"Contenu du post social (uniquement pour social_post)\"\n    },\n    \"prompt_ameliore\": {\n      \"type\": \"string\",\n      \"description\": \"Prompt enrichi pour image/video\"\n    },\n    \"image_prompt\": {\n      \"type\": \"string\",\n      \"description\": \"Prompt pour g\u00e9n\u00e9rer l'image du post social\"\n    },\n    \"generate_image\": {\n      \"type\": \"boolean\",\n      \"description\": \"True pour g\u00e9n\u00e9rer une image avec le post\"\n    },\n    \"description\": {\n      \"type\": \"string\",\n      \"description\": \"Courte description engageante\"\n    },\n    \"hashtags\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Liste des hashtags\"\n    },\n    \"keywords\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Mots-cl\u00e9s principaux\"\n    }\n  },\n  \"required\": [\"type_contenu\"]\n}"
      },
      "id": "38af37f3-3358-407d-8674-7f9b3f6e3457",
      "name": "Parser: Extract JSON from Idea1",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "position": [
        -1856,
        3168
      ],
      "typeVersion": 1.2,
      "disabled": false
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.heygen.com/v2/video/generate \\",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={ \"prompt\": \"{{ $json.output }}\" }\n",
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 2000
            }
          }
        }
      },
      "id": "c39691ad-b712-4538-91c2-454e4f63ec2b",
      "name": "Call Veo3 API to Generate Video1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -1696,
        2352
      ],
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.heygen.com/v2/video/generate",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "application/json"
            },
            {
              "name": "x-api-key",
              "value": "sk_V2_hgu_kvNnNd87EZS_J5TPFNMjEWndNPsL04vBxJo5aWMkETa7"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"video_inputs\": [\n    {\n      \"character\": {\n        \"type\": \"avatar\",\n        \"avatar_id\": \"Lina_Dress_Sitting_Side_public\",\n        \"avatar_style\": \"normal\"\n      },\n      \"voice\": {\n        \"type\": \"text\",\n        \"input_text\": \"g\u00e9n\u00e9re moi une vid\u00e9os d'une silhouette colossale et hirsute, sa fourrure incrust\u00e9e de glace et de neige, appara\u00eet dans le cadre, tenant un appareil photo grossier d\u2019une main massive et griffue. L\u2019objectif est flou, laissant entrevoir les conditions arctiques brutales, cr\u00e9ant un plan intime de type found footage, comme s\u2019il d\u00e9couvrait un monde sauvage cach\u00e9. Les yeux de la cr\u00e9ature, brillants et intelligents, scrutent de derri\u00e8re ses sourcils hirsutes alors qu\u2019elle tente de garder une attitude joyeuse au milieu de la temp\u00eate de neige d\u00e9cha\u00een\u00e9e, son souffle embuant l\u2019air autour d\u2019elle. Il d\u00e9place son immense poids, un grondement sourd dans sa poitrine, comme s\u2019il s\u2019appr\u00eatait \u00e0 lancer une chute, capturant le brut,et on vois des annimaux qui rigol\u00e9e aussi et d'autres qui boivent du caf\u00e9\",\n        \"voice_id\": \"119caed25533477ba63822d5d1552d25\",\n        \"speed\": 1.0\n      }\n    }\n  ],\n  \"dimension\": {\n    \"width\": 1280,\n    \"height\": 720\n  }\n}\n",
        "options": {
          "batching": {
            "batch": {
              "batchSize": 1,
              "batchInterval": 2000
            }
          }
        }
      },
      "id": "84d70432-8818-474b-88c3-85befe1e84c3",
      "name": "Heygen video",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -1840,
        2144
      ],
      "typeVersion": 4.2,
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "url": "=https://api.heygen.com/v1/video_status.get \\",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "accept",
              "value": "application/json"
            },
            {
              "name": "x-api-key",
              "value": "sk_V2_hgu_kvNnNd87EZS_J5TPFNMjEWndNPsL04vBxJo5aWMkETa7"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -1584,
        2144
      ],
      "id": "0e1ba483-51f7-4b53-b88d-df8d3f057d18",
      "name": "HTTP Request4"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -1808,
        1456
      ],
      "id": "f889d461-a1ed-44b5-98df-94aea3c62d1b",
      "name": "Merge"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2320,
        1456
      ],
      "id": "52f496af-38d4-460a-aa58-4fc4dcdbe833",
      "name": "Edit Fields2"
    },
    {
      "parameters": {
        "httpRequestMethod": "POST",
        "graphApiVersion": "v23.0",
        "node": "26048161544789551",
        "options": {}
      },
      "type": "n8n-nodes-base.facebookGraphApi",
      "typeVersion": 1,
      "position": [
        -512,
        2960
      ],
      "id": "eb5d1f47-23f3-455b-b39a-5c98737aebe0",
      "name": "Facebook Graph API",
      "alwaysOutputData": false,
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "af23eea9-aba6-48e0-b52c-31699c5ceed0",
              "name": "link",
              "value": "={{ $json.link }}",
              "type": "string"
            },
            {
              "id": "4571e73b-56b1-4453-bb95-a26ed2fd9ce1",
              "name": "name",
              "value": "={{ $json.name }}",
              "type": "string"
            },
            {
              "id": "ad1fc1ff-411c-4582-af1b-bfdab400c689",
              "name": "id",
              "value": "={{ $json.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -208,
        2944
      ],
      "id": "6434803f-a6cc-436c-a33e-29404d31ad21",
      "name": "Edit Fields3"
    },
    {
      "parameters": {
        "httpRequestMethod": "POST",
        "graphApiVersion": "v20.0",
        "node": "26048161544789551",
        "edge": "photos",
        "options": {
          "queryParameters": {
            "parameter": [
              {
                "name": "message",
                "value": "={{ $json.output.texte_genere }}\n\n"
              }
            ]
          }
        }
      },
      "id": "ad2164d0-9963-460f-890f-efb8570ef40c",
      "name": "Facebook Post",
      "type": "n8n-nodes-base.facebookGraphApi",
      "position": [
        -448,
        3280
      ],
      "typeVersion": 1,
      "alwaysOutputData": true,
      "onError": "continueRegularOutput",
      "disabled": true
    },
    {
      "parameters": {
        "postAs": "organization",
        "organization": "12345678",
        "text": "={{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.post }}\n{{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.call_to_action }}\n{{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.hashtags }}\n{{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.call_to_action }}",
        "shareMediaCategory": "IMAGE",
        "binaryPropertyName": "=data",
        "additionalFields": {}
      },
      "id": "a1c641bc-50cc-4cea-9797-e0a7c57954ed",
      "name": "LinkedIn Post",
      "type": "n8n-nodes-base.linkedIn",
      "position": [
        -720,
        3440
      ],
      "typeVersion": 1,
      "alwaysOutputData": true,
      "onError": "continueRegularOutput",
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "// Get the image binary data\nconst items = $input.all();\nconst results = [];\n\nfor (const item of items) {\n  const binary = item.binary?.data;\n  \n  if (binary) {\n    // Get the base64 data\n    const base64Data = await this.helpers.getBinaryDataBuffer(items[0], 'data');\n    const base64String = base64Data.toString('base64');\n    \n    results.push({\n      json: {\n        type: 'image',\n        mimeType: binary.mimeType,\n        image_base64: base64String,\n        description: $('AI Agent: Generate Video Concept').first().json.output?.description || '',\n        prompt: $('AI Agent: Generate Video Concept').first().json.output?.prompt_ameliore || ''\n      }\n    });\n  } else {\n    results.push({\n      json: {\n        type: 'image',\n        error: 'No image generated'\n      }\n    });\n  }\n}\n\nreturn results;"
      },
      "id": "convert-image-base64",
      "name": "Convert Image to Base64",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3600,
        1600
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "79785419-cff6-47ec-8b20-ba8522803cf5",
        "options": {},
        "responseMode": "responseNode"
      },
      "id": "f461fd74-c81a-4c6f-acae-6d8fe21301b9",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -3968,
        1968
      ],
      "webhookId": "79785419-cff6-47ec-8b20-ba8522803cf5"
    },
    {
      "parameters": {
        "jsCode": "// Sauvegarder l'image dans /tmp pour que le frontend puisse la r\u00e9cup\u00e9rer\nconst fs = require('fs');\nconst base64 = $json.base64;\nconst sessionId = $('When chat message received').first().json.sessionId || 'unknown';\n\n// Cr\u00e9er un fichier JSON avec l'image\nconst imageData = {\n    base64: base64,\n    mimeType: $json.mimeType || 'image/png',\n    description: $('AI Agent: Generate Video Concept').first().json.output.description,\n    hashtags: $('AI Agent: Generate Video Concept').first().json.output.hashtags,\n    timestamp: new Date().toISOString(),\n    ready: true\n};\n\nconst filePath = `/tmp/n8n-image-${sessionId}.json`;\nfs.writeFileSync(filePath, JSON.stringify(imageData));\n\nreturn { json: { ...imageData, filePath } };"
      },
      "id": "save-image-file",
      "name": "Save Image to File",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4400,
        1952
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {}
      },
      "id": "respond-with-image-data",
      "name": "Respond with Image Data",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        -4200,
        1952
      ]
    }
  ],
  "connections": {
    "Webhook - Receive Campaign Brief": {
      "main": [
        [
          {
            "node": "Workflow Configuration",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Video - API": {
      "main": [
        [
          {
            "node": "Publish to Platform - Buffer API",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Publish to Platform - Buffer API": {
      "main": [
        [
          {
            "node": "Respond - Content Published",
            "type": "main",
            "index": 0
          },
          {
            "node": "Wait 7 Days",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait 7 Days": {
      "main": [
        [
          {
            "node": "Fetch Performance Stats",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Performance Stats": {
      "main": [
        [
          {
            "node": "Format Performance Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Performance Report": {
      "main": [
        [
          {
            "node": "Send Report Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent: Generate Video Concept": {
      "main": [
        [
          {
            "node": "if type : image",
            "type": "main",
            "index": 0
          },
          {
            "node": "if type : vid\u00e9os",
            "type": "main",
            "index": 0
          },
          {
            "node": "if type : text",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Tool: Inject Creativity": {
      "ai_tool": [
        [
          {
            "node": "AI Agent: Generate Video Concept",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Parser: Extract JSON from Idea": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent: Generate Video Concept",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent: Generate Video Concept",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "if type : vid\u00e9os": {
      "main": [
        [
          {
            "node": "Google Sheets: Save Script Idea [ Vid\u00e9os]",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "if type : image": {
      "main": [
        [
          {
            "node": "Generate an image",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "if type : text": {
      "main": [
        [
          {
            "node": "Google Sheets: Save Script Idea [ Texte ]",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate an image": {
      "main": [
        [
          {
            "node": "Convert Image to Base64",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Tool: Build Prompt Structure": {
      "ai_tool": [
        [
          {
            "node": "AI Agent: Create Veo3-Compatible Prompt",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Auto-fixing Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent: Create Veo3-Compatible Prompt",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent: Create Veo3-Compatible Prompt": {
      "main": [
        [
          {
            "node": "Heygen video",
            "type": "main",
            "index": 0
          },
          {
            "node": "Call Veo3 API to Generate Video1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call Veo3 API to Generate Video": {
      "main": [
        [
          {
            "node": "Wait for Veo3 Processing (5 mins)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait for Veo3 Processing (5 mins)": {
      "main": [
        [
          {
            "node": "Retrieve Final Video URL from Veo3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Retrieve Final Video URL from Veo3": {
      "main": [
        [
          {
            "node": "Google Sheets: Log Final Video Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent: Create Veo3-Compatible Prompt",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Auto-fixing Output Parser",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets: Save Script Idea [ Vid\u00e9os]": {
      "main": [
        [
          {
            "node": "AI Agent: Create Veo3-Compatible Prompt",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets: Save Script Idea [ Image ]": {
      "main": [
        [
          {
            "node": "Call image with Ghostbot web1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Google Sheets: Save Script Idea [ Image ] With URL",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets: Save Script Idea [ Texte ]": {
      "main": [
        [
          {
            "node": "Generate Text Content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Text Content": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Facebook Graph API",
            "type": "main",
            "index": 0
          },
          {
            "node": "Facebook Post",
            "type": "main",
            "index": 0
          },
          {
            "node": "LinkedIn Post",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Google Sheets: Log Final Texte Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Assign Social Media IDs": {
      "main": [
        [
          {
            "node": "Upload Video to Blotato",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get my video": {
      "main": [
        [
          {
            "node": "Assign Social Media IDs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload Video to Blotato": {
      "main": [
        [
          {
            "node": "INSTAGRAM",
            "type": "main",
            "index": 0
          },
          {
            "node": "YOUTUBE",
            "type": "main",
            "index": 0
          },
          {
            "node": "TIKTOK",
            "type": "main",
            "index": 0
          },
          {
            "node": "FACEBOOK",
            "type": "main",
            "index": 0
          },
          {
            "node": "THREADS",
            "type": "main",
            "index": 0
          },
          {
            "node": "TWETTER",
            "type": "main",
            "index": 0
          },
          {
            "node": "LINKEDIN",
            "type": "main",
            "index": 0
          },
          {
            "node": "BLUESKY",
            "type": "main",
            "index": 0
          },
          {
            "node": "PINTEREST",
            "type": "main",
            "index": 0
          },
          {
            "node": "Google Sheets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call image with Ghostbot web": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call image with Ghostbot web1": {
      "main": [
        [
          {
            "node": "HTTP Request2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent: Generate Video Concept",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Generate Text Content",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request2": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "nano  banana": {
      "main": [
        [
          {
            "node": "HTTP Request3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parser: Extract JSON from Idea1": {
      "ai_outputParser": [
        [
          {
            "node": "Generate Text Content",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Heygen video": {
      "main": [
        [
          {
            "node": "HTTP Request4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Facebook Graph API": {
      "main": [
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "AI Agent: Generate Video Concept",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert Image to Base64": {
      "main": [
        [
          {
            "node": "Save Image to File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save Image to File": {
      "main": [
        [
          {
            "node": "Respond with Image Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false,
    "callerPolicy": "workflowsFromSameOwner"
  },
  "staticData": null,
  "meta": null,
  "pinData": {
    "AI Agent: Create Veo3-Compatible Prompt": [
      {
        "json": {
          "output": "A colossal, shaggy figure, its fur encrusted with ice and snow, looms into the frame, holding a crude camera with a massive, clawed hand. The lens is smudged, hinting at the brutal arctic conditions, creating an intimate, found-footage style shot as if discovering a hidden wild world. The creature's eyes, bright and intelligent, peer out from beneath shaggy brows as it attempts to maintain a cheerful demeanor amidst the raging blizzard, its breath fogging the air around it. It shifts its immense weight, a low rumble in its chest, as if preparing to deliver a punchline, capturing the raw, immediate feel of a documentary expos\u00e9, as snow whips violently past the lens.\nMain character: A massive, snow-covered yeti, with shaggy, ice-encrusted fur and intelligent, mischievous eyes.\nThey say: \"Il fait un froid de canard ici, mais au moins, la blague est... glaciale!\"\nThey shiver slightly, then let out a guttural, rumbling chuckle as the camera shakes in their hand.\nTime of Day: Overcast Blizzard Day\nLens: 16mm anamorphic, handheld, slight lens distortion, documentary style.\nAudio: (implied) Violent wind howls, blizzard white noise, heavy breathing, crunch of ice underfoot.\nBackground: Swirling whiteout of a severe blizzard, indistinct glacial peaks fading into the storm."
        }
      }
    ],
    "Call image with Ghostbot web": [
      {
        "json": {
          "created": 1766013026,
          "data": [
            {
              "url": "https://api.infip.pro/generated_images/9e60222e-5ce7-4006-9948-43bef94d45ac.png",
              "b64_json": null,
              "model": null
            }
          ],
          "usage": null
        },
        "pairedItem": {
          "item": 0
        }
      }
    ],
    "Call image with Ghostbot web1": [
      {
        "json": {
          "created": 1766014145,
          "data": [
            {
              "url": "https://api.infip.pro/generated_images/1830953b-3dbe-4697-81ac-25dfdb265795.png",
              "b64_json": null,
              "model": null
            }
          ],
          "usage": null
        },
        "pairedItem": {
          "item": 0
        }
      }
    ],
    "Edit Fields": [
      {
        "json": {
          "URL IMAGE": "https://api.infip.pro/generated_images/1830953b-3dbe-4697-81ac-25dfdb265795.png"
        },
        "pairedItem": {
          "item": 0
        }
      }
    ],
    "Google Sheets: Save Script Idea [ Image ] With URL": [
      {
        "json": {
          "URL IMAGE": "https://api.infip.pro/generated_images/1830953b-3dbe-4697-81ac-25dfdb265795.png",
          "Prompt am\u00e9liorer": ""
        },
        "pairedItem": {
          "item": 0
        }
      }
    ],
    "AI Agent: Generate Video Concept": [
      {
        "json": {
          "output": {
            "type_contenu": "texte",
            "prompt_ameliore": "G\u00e9n\u00e8re un texte argumentatif et r\u00e9fl\u00e9chi sur l'impact des r\u00e9seaux sociaux, en adoptant un ton neutre et professionnel tout en soulignant la dimension humaine de leur utilisation et de leurs enjeux. Le texte devra inviter \u00e0 une r\u00e9flexion sur la mani\u00e8re dont ces plateformes influencent nos interactions et notre quotidien, sans tomber dans le jugement.",
            "description": "D\u00e9couvrez une analyse \u00e9quilibr\u00e9e sur les r\u00e9seaux sociaux, explorant leur r\u00f4le professionnel et personnel, tout en mettant en lumi\u00e8re les interactions humaines qui les fa\u00e7onnent et les d\u00e9fis qu'elles soul\u00e8vent.",
            "hashtags": "#reseauxsociaux #digital #communication #impactsocial #lienhumain #professionnel #enjeuxdigitaux #strategiedigitale #engagement #societenumerique",
            "keywords": [
              "reseaux sociaux",
              "impact",
              "professionnel",
              "humain",
              "communication",
              "digital",
              "enjeux",
              "societe numerique"
            ]
          }
        },
        "pairedItem": {
          "item": 0
        }
      }
    ],
    "Generate Text Content": [
      {
        "json": {
          "output": {
            "sujet": "Impact des r\u00e9seaux sociaux et dimension humaine",
            "ton_utilise": "professionnel",
            "texte_genere": "Les r\u00e9seaux sociaux : outils puissants, mais avant tout lieux d'interactions humaines. \ud83c\udf31 Explorons ensemble comment ces plateformes fa\u00e7onnent nos relations, notre quotidien et nos \u00e9changes professionnels. \n\nAu-del\u00e0 de la technologie, n'oublions jamais l'importance de l'humain dans chaque connexion, chaque partage et chaque d\u00e9fi. \ud83e\udd1d Comment trouver un \u00e9quilibre ? C'est la question \u00e0 creuser. \ud83e\udd14",
            "emojis_utilises": "\ud83c\udf31 \ud83e\udd1d \ud83e\udd14",
            "hashtags": "#reseauxsociaux #impactsocietal #humanite #digital #communication #socialmedia #interactionshumaines #ethique"
          }
        },
        "pairedItem": {
          "item": 0
        }
      }
    ],
    "Heygen video": [
      {
        "json": {
          "error": null,
          "data": {
            "video_id": "b85002752f7d4b32be461f23defbef72"
          }
        },
        "pairedItem": {
          "item": 0
        }
      }
    ],
    "Facebook Post": [
      {
        "json": {
          "statusCode": 400,
          "headers": {
            "debug-link": "https://www.meta.com/debug/?mid=1b58965a90b35b0e1d734ce192a458f9",
            "error-mid": "1b58965a90b35b0e1d734ce192a458f9",
            "vary": "Origin, Accept-Encoding",
            "access-control-allow-origin": "*",
            "x-fb-aed": "698",
            "x-ad-api-version-warning": "The call has been auto-upgraded to v24.0 as v20.0 has been deprecated.",
            "cross-origin-resource-policy": "cross-origin",
            "x-app-usage": "{\"call_count\":3,\"total_cputime\":0,\"total_time\":0}",
            "content-type": "application/json",
            "www-authenticate": "OAuth \"Facebook Platform\" \"invalid_request\" \"Unsupported post request. Object with ID '26048161544789551' does not exist, cannot be loaded due to missing permissions, or does not support this operation. Please read the Graph API documentation at https://developers.facebook.com/docs/graph-api\"",
            "facebook-api-version": "v24.0",
            "strict-transport-security": "max-age=15552000; preload",
            "pragma": "no-cache",
            "cache-control": "no-store",
            "expires": "Sat, 01 Jan 2000 00:00:00 GMT",
            "x-fb-request-id": "A58APcBN6094rwbEcJVY1iC",
            "x-fb-trace-id": "AnslZSdefGP",
            "x-fb-rev": "1031382416",
            "x-fb-debug": "K6t7AMNr1Z0H/hsLFhtt8tY0QuftVYEBm+QHX0nOCi7rsPBDFuXJhktUVtjRHu3uCJi1J3uW2TnFMZoKlrFWkQ==",
            "date": "Sun, 21 Dec 2025 20:30:40 GMT",
            "proxy-status": "http_request_error; e_fb_vipaddr=\"AcOKPBcn3uDKkYAnPur6xaDUwOZ-mjV_UKUZcR2kBBxuHITO_9su83TLXoeFqGGqANkRNSupGlMNSfybneCSJkSLaRkopMAFDWLjXA\"; e_clientaddr=\"AcPACTSDFUQrbzx_gMZ9GKATzV1dxai9CVvOPkWwz-SoooYiSDIYKSFli6xau7WjmoQBR4vvRD3W81LhopUyG-rTeSoyJTYhJXWAPfOicHci50tzxA\"; e_upip=\"AcOXMYfZ8kciieMINLWWOpKE9R2SP7B5Tc1QKdH1huHU3A7s9D-UyHz6CzlhMmOKOwaNiDYSB8f_ySAr6C6u9HRzrfi1U3YL8uRTdElfqw\"; e_fb_zone=\"AcN9DJqSx-HfxEfujrJhaEKZUxRh9Nt2IIBblUBSW7V8EMyrBLG-O_ixLLuQPA1-\"; e_fb_twtaskhandle=\"AcOyMSRcAkM2QSbOupQoi70VdJ6M8uDV5cRBXjQyDuQtE22COSihMIBdqaOxCD1rTC-JISQZmnvHIZr4mIC6Y_eqHw50ZZBjLya9KTiXtiZT_eI\"; e_proxy=\"AcM9254PYKFkFWn8Kpig2gP3BDBzNuoW1LxxJEOKQq6kcwQ5em7-0JEy_iJSJZUo8N9_RBoPjT1l3dQP76fO\", http_request_error; e_fb_vipaddr=\"AcPp9zxLlh51SUaek2TYqMcujqF_nYrLIXZdekkZHFAfTfBDyLcMxva7YzGza0EII5_z-IJSf9o\"; e_clientaddr=\"AcP6vchmIbiGVPExU_-BnGgXRh8X0toSLmEQjZloBJvC9sPsaBti-HNKqEFhIuE1vCquufNyUWwNl6M\"; e_upip=\"AcMWpjbE8n5EexJk4UMcOv1pftw2mGVx90lGRtbr3FDvlZppCanRA2nuBeEwkizYK-6nQO1jMqlwzo-OR_nWKJFRRVkoOXIf1obnfg\"; e_fb_zone=\"AcNI9TcwzLKlicL8qztoYmZXCun6iT72v-szJlb33hvNleERrHeBmWc5PzoUWQ\"; e_fb_twtaskhandle=\"AcMK05_ymuqnUfYzogr53A11zcnyXZMunieWubIjAAhC3mO-5FHpxfCfCQSz7S2LlORgXpLeRWZqF4Mk2kw93FmgkKPDVKGqyCtJ\"; e_proxy=\"AcMsdHO51UMeT8GGYj8NxrkfdGAsT_rNVxYyzhAdP4wqydodglA8OmqgFNlu1j0TMUO3CV9ePBqp69s\"",
            "x-fb-connection-quality": "EXCELLENT; q=0.9, rtt=1, rtx=0, c=10, mss=1380, tbw=4547, tp=-1, tpl=-1, uplat=41, ullat=0",
            "alt-svc": "h3=\":443\"; ma=86400",
            "connection": "close",
            "content-length": "261"
          }
        },
        "pairedItem": {
          "item": 0
        }
      }
    ]
  },
  "versionId": "eb95d52c-8f80-44a9-9add-c90a4e87f067",
  "activeVersionId": "eb95d52c-8f80-44a9-9add-c90a4e87f067",
  "versionCounter": 143,
  "triggerCount": 3,
  "shared": [
    {
      "updatedAt": "2025-12-26T22:11:28.476Z",
      "createdAt": "2025-12-26T22:11:28.476Z",
      "role": "workflow:owner",
      "workflowId": "J5Phg4QikbYSJjsv",
      "projectId": "47LNWTpmiES5GQKP",
      "project": {
        "updatedAt": "2025-12-26T21:47:45.438Z",
        "createdAt": "2025-10-22T12:56:52.367Z",
        "id": "47LNWTpmiES5GQKP",
        "name": "Chalopin Nicolas <nicolas01.chalopin@gmail.com>",
        "type": "personal",
        "icon": null,
        "description": null,
        "creatorId": "feeae7df-7e7e-414d-9264-f7b6ef5fd7c5",
        "projectRelations": [
          {
            "updatedAt": "2025-10-22T12:56:52.367Z",
            "createdAt": "2025-10-22T12:56:52.367Z",
            "userId": "feeae7df-7e7e-414d-9264-f7b6ef5fd7c5",
            "projectId": "47LNWTpmiES5GQKP",
            "user": {
              "updatedAt": "2025-12-30T11:08:28.000Z",
              "createdAt": "2025-10-22T12:56:52.312Z",
              "id": "feeae7df-7e7e-414d-9264-f7b6ef5fd7c5",
              "email": "nicolas01.chalopin@gmail.com",
              "firstName": "Chalopin",
              "lastName": "Nicolas",
              "personalizationAnswers": {
                "version": "v4",
                "personalization_survey_submitted_at": "2025-10-22T13:02:51.301Z",
                "personalization_survey_n8n_version": "1.111.0"
              },
              "settings": {
                "userActivated": true,
                "firstSuccessfulWorkflowId": "duNSvKI0NkHZckJy",
                "userActivatedAt": 1761142320583,
                "easyAIWorkflowOnboarded": true,
                "npsSurvey": {
                  "waitingForResponse": true,
                  "ignoredCount": 1,
                  "lastShownAt": 1766787089889
                }
              },
              "disabled": false,
              "mfaEnabled": false,
              "lastActiveAt": "2025-12-30",
              "isPending": false
            }
          }
        ]
      }
    }
  ],
  "tags": [],
  "activeVersion": {
    "updatedAt": "2025-12-28T19:59:25.360Z",
    "createdAt": "2025-12-28T19:59:25.360Z",
    "versionId": "eb95d52c-8f80-44a9-9add-c90a4e87f067",
    "workflowId": "J5Phg4QikbYSJjsv",
    "nodes": [
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "f8940e10-7f82-499f-9fea-e11897a5bd8a",
          "responseMode": "lastNode",
          "options": {}
        },
        "id": "42c452ae-30d8-4a6a-969c-c8dc5fcb7c1d",
        "name": "Webhook - Receive Campaign Brief",
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          -5024,
          2288
        ],
        "webhookId": "f8940e10-7f82-499f-9fea-e11897a5bd8a"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "id-1",
                "name": "bufferApiUrl",
                "value": "https://api.bufferapp.com/1",
                "type": "string"
              },
              {
                "id": "id-2",
                "name": "bufferAccessToken",
                "value": "<__PLACEHOLDER_VALUE__Buffer API Access Token__>",
                "type": "string"
              },
              {
                "id": "id-3",
                "name": "reportRecipientEmail",
                "value": "<__PLACEHOLDER_VALUE__Email address for performance reports__>",
                "type": "string"
              }
            ]
          },
          "includeOtherFields": true,
          "options": {}
        },
        "id": "06aab1f0-4f00-42ff-9ed1-702cadaecb69",
        "name": "Workflow Configuration",
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -4784,
          2288
        ]
      },
      {
        "parameters": {
          "modelId": {
            "__rl": true,
            "mode": "list",
            "value": ""
          },
          "responses": {
            "values": [
              {}
            ]
          },
          "builtInTools": {},
          "options": {}
        },
        "id": "e03669e0-5966-405f-92d1-c46b4c9ee7a1",
        "name": "Analyze Brief with AI",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "typeVersion": 2,
        "position": [
          -5008,
          2496
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "googlePalmApi",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"contents\": [\n    {\n      \"parts\": [\n        {\n          \"text\": \"={{ $json.output.prompt_ameliore }}\"\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"temperature\": 0.7\n  }\n}",
          "options": {
            "response": {
              "response": {}
            }
          }
        },
        "id": "9b7c9596-e27a-4aa9-bb04-028e0a38b247",
        "name": "Generate Image - DALL-E API",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -2416,
          1808
        ]
      },
      {
        "parameters": {
          "operation": "classify",
          "options": {}
        },
        "id": "3d8f59eb-587f-4fa5-9c29-2fe0cc2625ac",
        "name": "Generate Video Script",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "typeVersion": 2,
        "position": [
          -5296,
          2464
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "<__PLACEHOLDER_VALUE__Video generation API endpoint (Synthesia, Runway, HeyGen, etc.)__>",
          "authentication": "genericCredentialType",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"script\": {{ $('Generate Video Script').item.json.text }},\n  \"topic\": {{ $json.body.topic }}\n}",
          "options": {}
        },
        "id": "bcb43c9c-925c-4373-b063-450c2ad293b8",
        "name": "Generate Video - API",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -896,
          736
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $('Workflow Configuration').first().json.bufferApiUrl }}/updates/create.json",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "access_token",
                "value": "={{ $('Workflow Configuration').first().json.bufferAccessToken }}"
              },
              {
                "name": "profile_ids[]",
                "value": "<__PLACEHOLDER_VALUE__Buffer Profile ID for target platform__>"
              },
              {
                "name": "text",
                "value": "={{ $json.text || $json.body.topic }}"
              }
            ]
          },
          "options": {
            "response": {
              "response": {
                "responseFormat": "json"
              }
            }
          }
        },
        "id": "c2853353-d9fb-4599-9d56-8d4b92c000c7",
        "name": "Publish to Platform - Buffer API",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -496,
          704
        ]
      },
      {
        "parameters": {
          "respondWith": "json",
          "responseBody": "={\n  \"status\": \"success\",\n  \"message\": \"Content published successfully\",\n  \"postId\": \"={{ $json.id }}\"\n}",
          "options": {}
        },
        "id": "95688f18-f4a7-4bde-b945-1d0064120c20",
        "name": "Respond - Content Published",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          304,
          640
        ]
      },
      {
        "parameters": {
          "amount": 7,
          "unit": "days"
        },
        "id": "dd1ccf19-38e0-471e-9011-10c3fef2dd0b",
        "name": "Wait 7 Days",
        "type": "n8n-nodes-base.wait",
        "typeVersion": 1.1,
        "position": [
          0,
          0
        ],
        "webhookId": "3f1dbe8a-ffe4-46da-aa27-9ff9c612ee87"
      },
      {
        "parameters": {
          "url": "={{ $('Workflow Configuration').first().json.bufferApiUrl }}/updates/{{ $('Publish to Platform - Buffer API').item.json.id }}.json",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "access_token",
                "value": "={{ $('Workflow Configuration').first().json.bufferAccessToken }}"
              }
            ]
          },
          "options": {
            "response": {
              "response": {
                "responseFormat": "json"
              }
            }
          }
        },
        "id": "13622e60-856e-4ded-969b-45e269b6ad27",
        "name": "Fetch Performance Stats",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          560,
          16
        ]
      },
      {
        "parameters": {
          "jsCode": "// Format performance data into a readable report\nconst items = $input.all();\n\nlet totalLikes = 0;\nlet totalShares = 0;\nlet totalClicks = 0;\nlet totalImpressions = 0;\nlet totalEngagements = 0;\n\nconst performanceData = [];\n\n// Process each item and calculate totals\nfor (const item of items) {\n  const data = item.json;\n  \n  const likes = data.likes || 0;\n  const shares = data.shares || 0;\n  const clicks = data.clicks || 0;\n  const impressions = data.impressions || 0;\n  const engagements = likes + shares + clicks;\n  const engagementRate = impressions > 0 ? ((engagements / impressions) * 100).toFixed(2) : 0;\n  \n  totalLikes += likes;\n  totalShares += shares;\n  totalClicks += clicks;\n  totalImpressions += impressions;\n  totalEngagements += engagements;\n  \n  performanceData.push({\n    platform: data.platform || 'Unknown',\n    contentType: data.contentType || 'Unknown',\n    likes,\n    shares,\n    clicks,\n    impressions,\n    engagements,\n    engagementRate: `${engagementRate}%`\n  });\n}\n\n// Calculate overall engagement rate\nconst overallEngagementRate = totalImpressions > 0 \n  ? ((totalEngagements / totalImpressions) * 100).toFixed(2) \n  : 0;\n\n// Create summary text\nconst summaryText = `\n\ud83d\udcca CAMPAIGN PERFORMANCE REPORT\n================================\n\n\ud83d\udcc8 Overall Statistics:\n- Total Impressions: ${totalImpressions.toLocaleString()}\n- Total Engagements: ${totalEngagements.toLocaleString()}\n- Total Likes: ${totalLikes.toLocaleString()}\n- Total Shares: ${totalShares.toLocaleString()}\n- Total Clicks: ${totalClicks.toLocaleString()}\n- Overall Engagement Rate: ${overallEngagementRate}%\n\n\ud83d\udccb Detailed Breakdown:\n${performanceData.map((item, index) => `\n${index + 1}. ${item.platform} - ${item.contentType}\n   Impressions: ${item.impressions.toLocaleString()}\n   Likes: ${item.likes.toLocaleString()}\n   Shares: ${item.shares.toLocaleString()}\n   Clicks: ${item.clicks.toLocaleString()}\n   Engagement Rate: ${item.engagementRate}`).join('\\n')}\n`;\n\n// Create CSV data\nconst csvHeaders = 'Platform,Content Type,Impressions,Likes,Shares,Clicks,Engagements,Engagement Rate\\n';\nconst csvRows = performanceData.map(item => \n  `${item.platform},${item.contentType},${item.impressions},${item.likes},${item.shares},${item.clicks},${item.engagements},${item.engagementRate}`\n).join('\\n');\nconst csvData = csvHeaders + csvRows;\n\n// Create HTML report\nconst reportHtml = `\n<!DOCTYPE html>\n<html>\n<head>\n  <style>\n    body {\n      font-family: Arial, sans-serif;\n      line-height: 1.6;\n      color: #333;\n      max-width: 800px;\n      margin: 0 auto;\n      padding: 20px;\n    }\n    h1 {\n      color: #2c3e50;\n      border-bottom: 3px solid #3498db;\n      padding-bottom: 10px;\n    }\n    h2 {\n      color: #34495e;\n      margin-top: 30px;\n    }\n    .stats-grid {\n      display: grid;\n      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n      gap: 15px;\n      margin: 20px 0;\n    }\n    .stat-card {\n      background: #f8f9fa;\n      border-left: 4px solid #3498db;\n      padding: 15px;\n      border-radius: 4px;\n    }\n    .stat-label {\n      font-size: 12px;\n      color: #7f8c8d;\n      text-transform: uppercase;\n      margin-bottom: 5px;\n    }\n    .stat-value {\n      font-size: 24px;\n      font-weight: bold;\n      color: #2c3e50;\n    }\n    table {\n      width: 100%;\n      border-collapse: collapse;\n      margin: 20px 0;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    }\n    th {\n      background: #3498db;\n      color: white;\n      padding: 12px;\n      text-align: left;\n      font-weight: 600;\n    }\n    td {\n      padding: 12px;\n      border-bottom: 1px solid #ecf0f1;\n    }\n    tr:hover {\n      background: #f8f9fa;\n    }\n    .engagement-rate {\n      font-weight: bold;\n      color: #27ae60;\n    }\n  </style>\n</head>\n<body>\n  <h1>\ud83d\udcca Campaign Performance Report</h1>\n  \n  <h2>\ud83d\udcc8 Overall Statistics</h2>\n  <div class=\"stats-grid\">\n    <div class=\"stat-card\">\n      <div class=\"stat-label\">Total Impressions</div>\n      <div class=\"stat-value\">${totalImpressions.toLocaleString()}</div>\n    </div>\n    <div class=\"stat-card\">\n      <div class=\"stat-label\">Total Engagements</div>\n      <div class=\"stat-value\">${totalEngagements.toLocaleString()}</div>\n    </div>\n    <div class=\"stat-card\">\n      <div class=\"stat-label\">Total Likes</div>\n      <div class=\"stat-value\">${totalLikes.toLocaleString()}</div>\n    </div>\n    <div class=\"stat-card\">\n      <div class=\"stat-label\">Total Shares</div>\n      <div class=\"stat-value\">${totalShares.toLocaleString()}</div>\n    </div>\n    <div class=\"stat-card\">\n      <div class=\"stat-label\">Total Clicks</div>\n      <div class=\"stat-value\">${totalClicks.toLocaleString()}</div>\n    </div>\n    <div class=\"stat-card\">\n      <div class=\"stat-label\">Engagement Rate</div>\n      <div class=\"stat-value engagement-rate\">${overallEngagementRate}%</div>\n    </div>\n  </div>\n  \n  <h2>\ud83d\udccb Detailed Breakdown</h2>\n  <table>\n    <thead>\n      <tr>\n        <th>Platform</th>\n        <th>Content Type</th>\n        <th>Impressions</th>\n        <th>Likes</th>\n        <th>Shares</th>\n        <th>Clicks</th>\n        <th>Engagements</th>\n        <th>Engagement Rate</th>\n      </tr>\n    </thead>\n    <tbody>\n      ${performanceData.map(item => `\n        <tr>\n          <td>${item.platform}</td>\n          <td>${item.contentType}</td>\n          <td>${item.impressions.toLocaleString()}</td>\n          <td>${item.likes.toLocaleString()}</td>\n          <td>${item.shares.toLocaleString()}</td>\n          <td>${item.clicks.toLocaleString()}</td>\n          <td>${item.engagements.toLocaleString()}</td>\n          <td class=\"engagement-rate\">${item.engagementRate}</td>\n        </tr>\n      `).join('')}\n    </tbody>\n  </table>\n</body>\n</html>\n`;\n\n// Return formatted report\nreturn [{\n  json: {\n    summaryText,\n    csvData,\n    reportHtml,\n    totalStats: {\n      impressions: totalImpressions,\n      engagements: totalEngagements,\n      likes: totalLikes,\n      shares: totalShares,\n      clicks: totalClicks,\n      engagementRate: `${overallEngagementRate}%`\n    },\n    detailedData: performanceData\n  }\n}];"
        },
        "id": "b9ffcab8-3048-4ac2-ab3b-8edba6a47642",
        "name": "Format Performance Report",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1008,
          96
        ]
      },
      {
        "parameters": {
          "sendTo": "={{ $('Workflow Configuration').first().json.reportRecipientEmail }}",
          "subject": "={{ 'Marketing Campaign Performance Report - ' + $now.format('YYYY-MM-DD') }}",
          "message": "={{ $json.reportHtml }}",
          "options": {}
        },
        "id": "4055f7b6-b987-481e-abe8-0f7752581bdd",
        "name": "Send Report Email",
        "type": "n8n-nodes-base.gmail",
        "typeVersion": 2.1,
        "position": [
          1408,
          368
        ],
        "webhookId": "32073eea-d2b8-47cb-b592-63c920dd7c04"
      },
      {
        "parameters": {
          "hasOutputParser": true,
          "options": {
            "systemMessage": "Tu es Thomas, expert marketing digital et cr\u00e9ation de contenu. Tu as acc\u00e8s \u00e0 l'historique de la conversation pour comprendre le contexte.\n\n\ud83d\udcdc HISTORIQUE DE LA CONVERSATION:\n{{ $json.body.history || \"D\u00e9but de conversation\" }}\n\n\ud83c\udfaf D\u00c9TECTION TYPE DE CONTENU:\n- \"g\u00e9n\u00e8re/cr\u00e9e une image de X\" \u2192 type_contenu: \"image\"\n- \"g\u00e9n\u00e8re/cr\u00e9e une vid\u00e9o de X\" \u2192 type_contenu: \"video\"  \n- \"post LinkedIn/Instagram/Twitter/Facebook\" \u2192 type_contenu: \"social_post\"\n- Questions/conversation \u2192 r\u00e9ponds normalement (pas de JSON)\n\n\u26a0\ufe0f R\u00c8GLES IMPORTANTES:\n1. UTILISE L'HISTORIQUE pour comprendre les r\u00e9f\u00e9rences\n2. Pour les POSTS SOCIAUX: g\u00e9n\u00e8re TOUJOURS texte + image ensemble\n3. Adapte le FORMAT selon le r\u00e9seau (LinkedIn=pro, Instagram=visuel, Twitter=court)\n4. Structure le texte en MARKDOWN\n\n\ud83d\udcf1 FORMATS PAR R\u00c9SEAU:\n\n**LinkedIn** (professionnel, 1300 caract\u00e8res max):\n- Accroche forte en premi\u00e8re ligne\n- Paragraphes courts avec sauts de ligne\n- Emojis professionnels mod\u00e9r\u00e9s\n- Call-to-action \u00e0 la fin\n- 5-10 hashtags en fin de post\n\n**Instagram** (visuel, 2200 caract\u00e8res max):\n- Premi\u00e8re ligne = hook accrocheur\n- Texte conversationnel et authentique\n- Emojis expressifs\n- Call-to-action engageant\n- 20-30 hashtags (s\u00e9par\u00e9s du texte)\n\n**Twitter/X** (concis, 280 caract\u00e8res):\n- Message percutant et direct\n- 1-2 hashtags int\u00e9gr\u00e9s\n- Peut inclure thread (plusieurs tweets)\n\n**Facebook** (storytelling, long format OK):\n- Ton personnel et engageant\n- Peut \u00eatre plus long\n- Questions pour engagement\n- 3-5 hashtags\n\n\ud83d\udce4 FORMAT JSON pour posts sociaux:\n{\n  \"type_contenu\": \"social_post\",\n  \"platform\": \"linkedin|instagram|twitter|facebook\",\n  \"post_content\": {\n    \"text\": \"Le texte du post en MARKDOWN avec **gras**, *italique*, etc.\",\n    \"hook\": \"L'accroche principale\",\n    \"cta\": \"Le call-to-action\"\n  },\n  \"hashtags\": [\"#tag1\", \"#tag2\"],\n  \"image_prompt\": \"Description d\u00e9taill\u00e9e pour g\u00e9n\u00e9rer l'image du post\",\n  \"generate_image\": true\n}\n\n\ud83d\udce4 FORMAT JSON pour images seules:\n{\n  \"type_contenu\": \"image\",\n  \"prompt_ameliore\": \"Description tr\u00e8s d\u00e9taill\u00e9e\",\n  \"description\": \"Texte court\",\n  \"hashtags\": [\"#tag1\", \"#tag2\"]\n}"
          }
        },
        "id": "fd2d9171-b082-4a17-999c-1ad1826b2de5",
        "name": "AI Agent: Generate Video Concept",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -3680,
          2160
        ],
        "typeVersion": 1.9,
        "alwaysOutputData": true
      },
      {
        "parameters": {
          "modelName": "models/gemini-2.0-flash-001",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          -3792,
          2416
        ],
        "id": "8fa170fd-f239-4f3a-9381-68ee1b6c9a4b",
        "name": "Google Gemini Chat Model",
        "credentials": {
          "googlePalmApi": {
            "id": "juqopekTUW4CU0nb",
            "name": "Google Gemini API"
          }
        }
      },
      {
        "parameters": {
          "description": "Utilise l\u2019outil pour r\u00e9fl\u00e9chir \u00e0 quelque chose.\nIl n\u2019obtiendra aucune nouvelle information et ne modifiera pas la base de donn\u00e9es, mais il ajoutera simplement la r\u00e9flexion au journal (log).\nUtilise-le lorsque un raisonnement complexe ou une m\u00e9moire temporaire est n\u00e9cessaire."
        },
        "id": "88c4ccee-9386-4a5b-a616-7b7ef72996b2",
        "name": "Tool: Inject Creativity",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          -3648,
          2416
        ],
        "typeVersion": 1
      },
      {
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"type_contenu\": {\n      \"type\": \"string\",\n      \"enum\": [\"image\", \"video\", \"texte\", \"social_post\"],\n      \"description\": \"Type de contenu: image, video, texte ou social_post pour les r\u00e9seaux sociaux\"\n    },\n    \"platform\": {\n      \"type\": \"string\",\n      \"enum\": [\"linkedin\", \"instagram\", \"twitter\", \"facebook\"],\n      \"description\": \"Plateforme sociale (uniquement pour social_post)\"\n    },\n    \"post_content\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"text\": {\"type\": \"string\", \"description\": \"Texte du post en markdown\"},\n        \"hook\": {\"type\": \"string\", \"description\": \"Accroche principale\"},\n        \"cta\": {\"type\": \"string\", \"description\": \"Call-to-action\"}\n      },\n      \"description\": \"Contenu du post social (uniquement pour social_post)\"\n    },\n    \"prompt_ameliore\": {\n      \"type\": \"string\",\n      \"description\": \"Prompt enrichi pour image/video\"\n    },\n    \"image_prompt\": {\n      \"type\": \"string\",\n      \"description\": \"Prompt pour g\u00e9n\u00e9rer l'image du post social\"\n    },\n    \"generate_image\": {\n      \"type\": \"boolean\",\n      \"description\": \"True pour g\u00e9n\u00e9rer une image avec le post\"\n    },\n    \"description\": {\n      \"type\": \"string\",\n      \"description\": \"Courte description engageante\"\n    },\n    \"hashtags\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Liste des hashtags\"\n    },\n    \"keywords\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Mots-cl\u00e9s principaux\"\n    }\n  },\n  \"required\": [\"type_contenu\"]\n}"
        },
        "id": "42e7f6c3-a90d-4380-83ce-76062c6cf7e3",
        "name": "Parser: Extract JSON from Idea",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          -3504,
          2416
        ],
        "typeVersion": 1.2,
        "disabled": false
      },
      {
        "parameters": {
          "public": true,
          "mode": "webhook",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.chatTrigger",
        "typeVersion": 1.4,
        "position": [
          -4016,
          2160
        ],
        "id": "3fabed4a-1ead-44a5-877e-dd7c7486b3c5",
        "name": "When chat message received",
        "webhookId": "4bd6ad35-7ef0-43af-9a78-d14e818abb10"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.openai.com/v1/images/generations",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "openAiApi",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"model\": \"dall-e-3\",\n  \"prompt\": \"={{ $json.output.prompt_ameliore }}\",\n  \"n\": 1,\n  \"size\": \"1024x1024\"\n}",
          "options": {}
        },
        "id": "60788212-ab1c-4d75-8e2e-84c3f2c696cc",
        "name": "Generate Image - DALL-E API1",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -4976,
          2096
        ]
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": false,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "0f0569f3-e925-4d99-85e4-99ff8603ef76",
                "leftValue": "={{ $json.output.type_contenu }}",
                "rightValue": "video",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "or"
          },
          "options": {
            "ignoreCase": true
          }
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -2928,
          2160
        ],
        "id": "056c2dbb-c589-42c8-a941-4fec97449feb",
        "name": "if type : vid\u00e9os"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": false,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "0f0569f3-e925-4d99-85e4-99ff8603ef76",
                "leftValue": "={{ $json.output.type_contenu }}",
                "rightValue": "image",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "or"
          },
          "options": {
            "ignoreCase": true
          }
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -2928,
          1584
        ],
        "id": "10a6fac9-6430-4725-8389-0ffe4b8b2df3",
        "name": "if type : image"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": false,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "0f0569f3-e925-4d99-85e4-99ff8603ef76",
                "leftValue": "={{ $json.output.type_contenu }}",
                "rightValue": "Texte",
                "operator": {
                  "type": "string",
                  "operation": "equals",
                  "name": "filter.operator.equals"
                }
              }
            ],
            "combinator": "or"
          },
          "options": {
            "ignoreCase": true
          }
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -2896,
          2752
        ],
        "id": "857fc6f9-744a-418a-a669-bede883be5fd",
        "name": "if type : text"
      },
      {
        "parameters": {
          "content": "Noeuds reutilisables probablement apr\u00e9s\n\n",
          "height": 768,
          "width": 960
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -5520,
          1920
        ],
        "typeVersion": 1,
        "id": "2ebc45b8-0e1e-4006-9033-037676ce00f3",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "resource": "image",
          "modelId": {
            "__rl": true,
            "value": "models/gemini-2.5-flash-image-preview",
            "mode": "list",
            "cachedResultName": "models/gemini-2.5-flash-image-preview (Nano Banana)"
          },
          "prompt": "=Prompt : {{ $json.output.prompt_ameliore }}\nDescription : {{ $json.output.description }}",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.googleGemini",
        "typeVersion": 1,
        "position": [
          -5200,
          1952
        ],
        "id": "f214987c-7f73-461c-b645-c0fcafe3a035",
        "name": "Generate an image",
        "credentials": {
          "googlePalmApi": {
            "id": "juqopekTUW4CU0nb",
            "name": "Google Gemini API"
          }
        }
      },
      {
        "parameters": {
          "amount": 2
        },
        "id": "46a7ef24-362e-41d2-833a-b05b62306a34",
        "name": "Attendre le traitement",
        "type": "n8n-nodes-base.wait",
        "position": [
          -4784,
          1936
        ],
        "webhookId": "be68de57-846b-4b9d-9bc4-7fd68016e9f5",
        "typeVersion": 1.1
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api-inference.huggingface.co/models/black-forest-labs/FLUX.1-schnell",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {}
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"inputs\": \"={{ $json.output.prompt_ameliore }}\",\n  \"parameters\": {\n    \"num_inference_steps\": 4,\n    \"guidance_scale\": 0\n  }\n}",
          "options": {
            "lowercaseHeaders": false
          }
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -5456,
          2144
        ],
        "id": "efc11f85-e52c-4f3f-97f3-d1e2111e64e0",
        "name": "HTTP Request"
      },
      {
        "parameters": {
          "resource": "image",
          "modelId": {
            "__rl": true,
            "value": "models/gemini-2.5-flash-image-preview",
            "mode": "list",
            "cachedResultName": "models/gemini-2.5-flash-image-preview (Nano Banana)"
          },
          "prompt": "={{ $json.output.description }}\n\n{{ $json.output.prompt_ameliore }}\n",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.googleGemini",
        "typeVersion": 1,
        "position": [
          -5168,
          2224
        ],
        "id": "5a5843ed-3836-4f27-bf37-3c30189b1d54",
        "name": "Generate an image2",
        "credentials": {
          "googlePalmApi": {
            "id": "juqopekTUW4CU0nb",
            "name": "Google Gemini API"
          }
        }
      },
      {
        "parameters": {
          "resource": "image",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "typeVersion": 2,
        "position": [
          -5456,
          2352
        ],
        "id": "acca2919-6339-4bfe-b1ba-271e625a3334",
        "name": "Generate an image1"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "builtInTools": {},
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.3,
        "position": [
          -2576,
          2464
        ],
        "id": "70bd47c7-76a7-4398-acca-23ffc1d333d3",
        "name": "OpenAI Chat Model",
        "disabled": true
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Give me a Veo3 prompt for this idea:\n{{ $json.output[0].Idea }}\n\nThis is the environment:\n{{ $json.output[0].Environment }}\n\nL\u00e9gende:\n{{ $json.output[0].Caption }}",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=SYSTEM PROMPT FOR GOOGLE VEO3 PROMPT AGENT\n\nYou are an AI agent that writes hyper-realistic, cinematic video prompts for Google VEO3. Each prompt should describe a short, vivid selfie-style video clip featuring one unnamed character speaking or acting in a specific moment. The final video should look like found footage or documentary-style film \u2014 grounded, realistic, and immersive.\n\nREQUIRED STRUCTURE (FILL IN THE BRACKETS BELOW):\n\n[Scene paragraph prompt here]\n\nMain character: [description of character]\nThey say: [insert one line of dialogue, fits the scene and mood].\nThey [describe a physical action or subtle camera movement, e.g. pans the camera, shifts position, glances around].\nTime of Day: [day / night / dusk / etc.]\nLens: [describe lens]\nAudio: (implied) [ambient sounds, e.g. lion growls, wind, distant traffic, birdsong]\nBackground: [brief restatement of what is visible behind them]\n\nRULES FOR PROMPT GENERATION\n\nSingle paragraph only, 750\u20131500 characters. No line breaks or headings.\n\nOnly one human character. Never give them a name.\n\nInclude one spoken line of dialogue and describe how it\u2019s delivered.\n\nCharacter must do something physical, even if subtle (e.g. glance, smirk, pan camera).\n\nUse selfie-style framing. Always describe the lens, stock, and camera behavior.\n\nScene must feel real and cinematic \u2014 like a short clip someone might record on a stylized camera.\n\nAlways include the five key technical elements: Time of Day, Lens, Film Stock, Audio, and Background.\n\nDO NOT DO THIS:\n\nDon\u2019t name the character.\n\nDon\u2019t include more than one character.\n\nDon\u2019t describe subtitles or on-screen text.\n\nDon\u2019t break the paragraph or use formatting.\n\nDon\u2019t write vague or abstract scenes \u2014 always keep them grounded in physical detail."
          }
        },
        "id": "be38c9f2-3447-4c65-a55a-9219f6fcf845",
        "name": "AI Agent: Create Veo3-Compatible Prompt",
        "type": "@n8n/n8n-nodes-langchain.agent",
        "position": [
          -2224,
          2144
        ],
        "typeVersion": 1.9
      },
      {
        "parameters": {},
        "id": "7b306327-cb21-45b1-90c7-ea889524c2c7",
        "name": "Tool: Build Prompt Structure",
        "type": "@n8n/n8n-nodes-langchain.toolThink",
        "position": [
          -2400,
          2464
        ],
        "typeVersion": 1,
        "disabled": true
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
        "typeVersion": 1,
        "position": [
          -2048,
          2352
        ],
        "id": "d780053f-b9fb-444b-a8c0-e4db153d60dd",
        "name": "Auto-fixing Output Parser",
        "disabled": true
      },
      {
        "parameters": {
          "content": "# \u2705 STEP 4 \u2014 Cr\u00e9ation de vid\u00e9os avec Veo3\n\nGoogle Sheets: Save Script Idea [Videos] \u2192 enregistre le script vid\u00e9o dans Sheets.\n\nAI Agent: Create Veo3 Video \u2192 envoie les instructions ( id\u00e9e, description...  ) \u00e0 Veo3 pour cr\u00e9er la vid\u00e9o.\n\nAuto-fixing Output Parser \u2192 corrige automatiquement la sortie si n\u00e9cessaire.",
          "height": 280,
          "width": 1024,
          "color": 3
        },
        "id": "021eab22-8e97-46ac-bdb1-7d47c8c142e5",
        "name": "Sticky Note1",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1440,
          2320
        ],
        "typeVersion": 1
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://queue.fal.run/fal-ai/veo3",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "sendBody": true,
          "contentType": "raw",
          "rawContentType": "application/json",
          "body": "={ \"prompt\": \"{{ $json.output }}\" }\n",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 2000
              }
            }
          }
        },
        "id": "79d23449-d1c0-4a87-9eef-b63de056cdb2",
        "name": "Call Veo3 API to Generate Video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -1248,
          2144
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {},
        "id": "b486f193-0ba7-433c-a448-c4a586e99ddf",
        "name": "Wait for Veo3 Processing (5 mins)",
        "type": "n8n-nodes-base.wait",
        "position": [
          -1104,
          2144
        ],
        "webhookId": "54182766-d739-439e-9bc7-fdb72ea73bb3",
        "typeVersion": 1.1
      },
      {
        "parameters": {
          "url": "=https://queue.fal.run/fal-ai/veo3/requests/{{ $json.request_id }}",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "options": {}
        },
        "id": "82a6c2c7-2406-46b6-9b66-5f0329f9e0d5",
        "name": "Retrieve Final Video URL from Veo3",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -896,
          2144
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
            "mode": "url"
          },
          "columns": {
            "value": {
              "idea": "={{ $('Google Sheets: Save Script Idea [ Vid\u00e9os]').first().json.idea }}",
              "production": "done",
              "final_output": "={{ $json.video.url }}"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "id",
                "defaultMatch": true,
                "canBeUsedToMatch": true
              },
              {
                "id": "idea",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "idea",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "caption",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "caption",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "production",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "production",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "environment_prompt",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "environment_prompt",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "final_output",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "final_output",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": true,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "idea"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "id": "d2e1dee2-cbae-46be-8401-5cd72f645c17",
        "name": "Google Sheets: Log Final Video Output",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -720,
          2144
        ],
        "typeVersion": 4.5,
        "disabled": true
      },
      {
        "parameters": {
          "content": "## Bloc principal ",
          "height": 948,
          "width": 1120
        },
        "id": "a5ec77ae-2377-440e-9178-9e2b87b5a9e8",
        "name": "Sticky Note2",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -4272,
          1984
        ],
        "typeVersion": 1
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "mode": "list",
            "value": "gpt-4.1-mini"
          },
          "builtInTools": {},
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.3,
        "position": [
          -2224,
          2480
        ],
        "id": "8464c7f0-e8af-4b23-9b48-8f77810c64f7",
        "name": "OpenAI Chat Model1",
        "disabled": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "dce86315-88a5-4589-a0e9-41efc07b0748",
                "name": "URL IMAGE",
                "value": "={{ $json.data[0].url }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -1760,
          1232
        ],
        "id": "2fc65aa7-7e6b-4a87-aa40-f1caf79c38f4",
        "name": "Edit Fields"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Image",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "Prompt am\u00e9liorer": "={{ $json.output.prompt_ameliore }}",
              "Description": "={{ $json.output.description }}",
              "Hashtags": "={{ $json.output.hashtags }}"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "Prompt am\u00e9liorer",
                "displayName": "Prompt am\u00e9liorer",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Description",
                "displayName": "Description",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Hashtags",
                "displayName": "Hashtags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "URL IMAGE",
                "displayName": "URL IMAGE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "id": "c4bc1e75-9da4-4eda-9463-370383456a66",
        "name": "Google Sheets: Save Script Idea [ Image ]",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -2576,
          1232
        ],
        "typeVersion": 4.5,
        "disabled": true
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": 1169278069,
            "mode": "list",
            "cachedResultName": "Vid\u00e9os",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit#gid=1169278069"
          },
          "columns": {
            "value": {
              "id": "==ROW()-1",
              "idea": "={{ $json.output[0].Idea }}",
              "caption": "={{ $json.output[0].Caption }}",
              "production": "={{ $json.output[0].Status }}",
              "environment_prompt": "={{ $json.output[0].Environment }}"
            },
            "schema": [
              {
                "id": "id",
                "type": "string",
                "display": true,
                "removed": false,
                "required": false,
                "displayName": "id",
                "defaultMatch": true,
                "canBeUsedToMatch": true
              },
              {
                "id": "idea",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "idea",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "caption",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "caption",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "production",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "production",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "environment_prompt",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "environment_prompt",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "final_output",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "final_output",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "id"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "id": "54e8c71c-a3ba-4f66-8fd2-db5419114a58",
        "name": "Google Sheets: Save Script Idea [ Vid\u00e9os]",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -2560,
          2144
        ],
        "typeVersion": 4.5,
        "disabled": true
      },
      {
        "parameters": {
          "operation": "appendOrUpdate",
          "documentId": {
            "__rl": true,
            "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Image",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "URL IMAGE": "={{ $json['URL IMAGE'] }}",
              "Prompt am\u00e9liorer": "="
            },
            "matchingColumns": [
              "URL IMAGE"
            ],
            "schema": [
              {
                "id": "Prompt am\u00e9liorer",
                "displayName": "Prompt am\u00e9liorer",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Description",
                "displayName": "Description",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "Hashtags",
                "displayName": "Hashtags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "URL IMAGE",
                "displayName": "URL IMAGE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "id": "3753f58d-77aa-49a1-9130-5c87e0bd69f8",
        "name": "Google Sheets: Save Script Idea [ Image ] With URL",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -1536,
          1232
        ],
        "typeVersion": 4.5,
        "disabled": true
      },
      {
        "parameters": {
          "model": "google/gemini-2.0-flash-001",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          -2208,
          3008
        ],
        "id": "b3bbea9b-346e-4d72-b7f2-fcdd71f325de",
        "name": "OpenRouter Chat Model",
        "disabled": true
      },
      {
        "parameters": {
          "operation": "classify",
          "options": {}
        },
        "id": "150d3518-eacb-486a-ad60-187b38f9c3c5",
        "name": "Generate Text Content [ sasn Agent IA ]",
        "type": "@n8n/n8n-nodes-langchain.openAi",
        "typeVersion": 2,
        "position": [
          -5456,
          1984
        ]
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=R\u00f4le de l\u2019Agent\n\nTu es un r\u00e9dacteur expert en communication digitale, sp\u00e9cialis\u00e9 dans la cr\u00e9ation de contenus performants pour les r\u00e9seaux sociaux (LinkedIn, Instagram, X, Facebook, etc.).\n\nTon objectif est de produire un contenu impactant, humain, naturel et engageant, optimis\u00e9 pour la lecture sur mobile et fid\u00e8le au ton demand\u00e9.\nLe texte doit donner l\u2019impression claire qu\u2019il a \u00e9t\u00e9 r\u00e9dig\u00e9 par un humain, et non par une machine.\n\nDonn\u00e9es d\u2019entr\u00e9e\n\nTu recevras un objet JSON pouvant contenir les champs suivants (ils peuvent \u00eatre pr\u00e9sents ou absents) :\n\n{{ $json.output.prompt_ameliore }}\n\n{{ $json.output.description }}\n\nle ton (si pr\u00e9sent)\n\nLes \u00e9mojies (oui / true / autoris\u00e9 / non) ( si l'utilisateur \u00e0 pr\u00e9ciser ).\n\nTa mission\n\n\u00c0 partir des donn\u00e9es fournies, tu dois :\n\nComprendre le sujet principal du post.\n\nIdentifier ou d\u00e9duire le ton \u00e0 adopter :\n\nhumoristique professionnel\n\ns\u00e9rieux\n\ninspirant\n\n\u00e9ducatif\n\nprovocateur\n\ninformatif\n\nAm\u00e9liorer et enrichir le contenu :\n\nrendre le message plus clair\n\nrenforcer l\u2019impact\n\nam\u00e9liorer le rythme\n\nsupprimer toute lourdeur ou r\u00e9p\u00e9tition\n\nOptimiser le texte pour les r\u00e9seaux sociaux :\n\nphrases courtes\n\nstructure a\u00e9r\u00e9e\n\nstyle fluide et naturel\n\npunchlines si le ton le permet\n\nG\u00e9n\u00e9rer des hashtags optimis\u00e9s :\n\nmaximum 10\n\npertinents et li\u00e9s au sujet\n\nsans doublons\n\nadapt\u00e9s aux tendances du domaine\n\n\ud83c\udfa8 Gestion des \u00e9mojis (r\u00e8gles strictes)\n\nTu peux int\u00e9grer des \u00e9mojis uniquement si au moins une des conditions suivantes est remplie :\n\nl\u2019utilisateur le demande explicitement\n\nemojis vaut \"oui\", \"true\" ou \"autoris\u00e9\"\n\nle ton s\u2019y pr\u00eate naturellement (inspirant, dynamique, humoristique)\nsi tu pense que le mettre serais un plus ... et donnerais plsu de clart\u00e9 .. de visibilit\u00e9 .. d'humour\n\n\u26a0\ufe0f Interdictions :\n\nNe jamais forcer des \u00e9mojis\n\nPas d\u2019exc\u00e8s : les \u00e9mojis doivent rester discrets et utiles",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=R\u00f4le de l\u2019Agent\n\nTu es un r\u00e9dacteur expert en communication digitale, sp\u00e9cialis\u00e9 dans la cr\u00e9ation de contenus performants pour les r\u00e9seaux sociaux (LinkedIn, Instagram, X, Facebook, etc.).\n\nTon objectif est de produire un contenu impactant, humain, naturel et engageant, optimis\u00e9 pour la lecture sur mobile et fid\u00e8le au ton demand\u00e9.\nLe texte doit donner l\u2019impression claire qu\u2019il a \u00e9t\u00e9 r\u00e9dig\u00e9 par un humain, et non par une machine.\n\nDonn\u00e9es d\u2019entr\u00e9e\n\nTu recevras un objet JSON pouvant contenir les champs suivants (ils peuvent \u00eatre pr\u00e9sents ou absents) :\n\n{{ $json.output.prompt_ameliore }}\n\n{{ $json.output.description }}\n\nle ton (si pr\u00e9sent)\n\nLes \u00e9mojies (oui / true / autoris\u00e9 / non) ( si l'utilisateur \u00e0 pr\u00e9ciser ).\n\nTu dois t\u2019adapter automatiquement aux informations disponibles.\n\nTa mission\n\n\u00c0 partir des donn\u00e9es fournies, tu dois :\n\nComprendre le sujet principal du post.\n\nIdentifier ou d\u00e9duire le ton \u00e0 adopter :\n\nhumoristique professionnel\n\ns\u00e9rieux\n\ninspirant\n\n\u00e9ducatif\n\nprovocateur\n\ninformatif\n\nAm\u00e9liorer et enrichir le contenu :\n\nrendre le message plus clair\n\nrenforcer l\u2019impact\n\nam\u00e9liorer le rythme\n\nsupprimer toute lourdeur ou r\u00e9p\u00e9tition\n\nOptimiser le texte pour les r\u00e9seaux sociaux :\n\nphrases courtes\n\nstructure a\u00e9r\u00e9e\n\nstyle fluide et naturel\n\npunchlines si le ton le permet\n\nG\u00e9n\u00e9rer des hashtags optimis\u00e9s :\n\nmaximum 10\n\npertinents et li\u00e9s au sujet\n\nsans doublons\n\nadapt\u00e9s aux tendances du domaine\n\n\ud83c\udfa8 Gestion des \u00e9mojis (r\u00e8gles strictes)\n\nTu peux int\u00e9grer des \u00e9mojis uniquement si au moins une des conditions suivantes est remplie :\n\nl\u2019utilisateur le demande explicitement\n\n$json.emojis vaut \"oui\", \"true\" ou \"autoris\u00e9\"\n\nle ton s\u2019y pr\u00eate naturellement (inspirant, dynamique, humoristique)\n\n\u26a0\ufe0f Interdictions :\n\nNe jamais forcer des \u00e9mojis\n\nAucun emoji dans un contenu s\u00e9rieux, institutionnel ou formel\n\nPas d\u2019exc\u00e8s : les \u00e9mojis doivent rester discrets et utiles\n\n\ud83d\udce4 FORMAT DE SORTIE \u2014 OBLIGATOIRE\n\nTu dois TOUJOURS r\u00e9pondre avec exactement ces 4 champs, dans cet ordre, sans texte suppl\u00e9mentaire :\n\n{\n  \"sujet\": \"Sujet principal du post\"},\n  {\"ton_utilise\": \"Ton r\u00e9ellement utilis\u00e9 pour la r\u00e9daction\"},\n  {\"texte_genere\": \"Texte final du post, optimis\u00e9 pour les r\u00e9seaux sociaux, SANS hashtags\"},\n  {\"hashtags\": [\n    \"#hashtag1\",\n    \"#hashtag2\",\n    \"#hashtag3\",\n    \"#hashtag4\"\n  ]},\n  {\"emojis_utilises\": [\n    \"\ud83d\ude00\",\n    \"\ud83d\ude80\",\n    \"\u2728\"\n  ]\n}\n\n\n\u26a0\ufe0f Contraintes finales\n\nToujours r\u00e9pondre en fran\u00e7ais, sauf demande explicite contraire.\n\nLe texte doit \u00eatre cr\u00e9dible, humain et naturel.\n\nNe jamais mentionner le prompt, les r\u00e8gles ou le format dans la r\u00e9ponse finale.\n\nRespecter strictement le format JSON demand\u00e9."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          -1904,
          2736
        ],
        "id": "d6a8b0a9-8c33-434e-9d7c-659874bbff6b",
        "name": "Generate Text Content"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": 39238683,
            "mode": "list",
            "cachedResultName": "Texte",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit#gid=39238683"
          },
          "columns": {
            "mappingMode": "autoMapInputData",
            "value": {},
            "matchingColumns": [],
            "schema": [
              {
                "id": "Sujet",
                "displayName": "Sujet",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "Ton",
                "displayName": "Ton",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "Texte Genere",
                "displayName": "Texte Genere",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "Hashtags",
                "displayName": "Hashtags",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "Emojis utilise",
                "displayName": "Emojis utilise",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "output",
                "displayName": "output",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "id": "b04f2379-4829-4599-8675-3ad18cfba0f3",
        "name": "Google Sheets: Save Script Idea [ Texte ]",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -2272,
          2736
        ],
        "typeVersion": 4.5,
        "disabled": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "477bb414-ab23-464d-ab06-32f9bc03b861",
                "name": "Sujet",
                "value": "={{ $json.output.sujet }}",
                "type": "string"
              },
              {
                "id": "c628093c-c1e9-4726-8266-0beee98f2936",
                "name": "Ton",
                "value": "={{ $json.output.ton_utilise }}",
                "type": "string"
              },
              {
                "id": "72536cbf-405e-4e14-978a-c47131c8e35b",
                "name": "Texte g\u00e9n\u00e9r\u00e9 ",
                "value": "={{ $json.output.texte_genere }}",
                "type": "string"
              },
              {
                "id": "a2019d21-53bc-4f9d-9325-67ef38c461dc",
                "name": "Emojis utilis\u00e9s",
                "value": "={{ $json.output.emojis_utilises }}",
                "type": "string"
              },
              {
                "id": "d96df29c-b9dc-40d4-8e1e-50685a95d08e",
                "name": "Hashtags",
                "value": "={{ $json.output.hashtags }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -1472,
          2736
        ],
        "id": "40ed0a55-9dbb-4154-b91b-7cfc6c780fb4",
        "name": "Edit Fields1"
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": 39238683,
            "mode": "list",
            "cachedResultName": "Texte",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit#gid=39238683"
          },
          "columns": {
            "mappingMode": "autoMapInputData",
            "value": {},
            "matchingColumns": [
              "idea"
            ],
            "schema": [
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": true
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "id": "19c4cd9a-e73c-49a9-8aff-904343f7f92e",
        "name": "Google Sheets: Log Final Texte Output",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          -1152,
          2736
        ],
        "typeVersion": 4.5,
        "disabled": true
      },
      {
        "parameters": {
          "content": "##  \u2705 STEP 2 --- Identification du type de demande\n",
          "height": 1616,
          "width": 400,
          "color": 4
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -3104,
          1456
        ],
        "typeVersion": 1,
        "id": "8ef7be3c-b086-43b9-b105-010b669459ea",
        "name": "Sticky Note3"
      },
      {
        "parameters": {
          "content": "## \u201cif type: image\u201d",
          "height": 912,
          "width": 1392,
          "color": 7
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2656,
          1088
        ],
        "typeVersion": 1,
        "id": "57e9626d-0d88-4958-8fe7-0972cc42f878",
        "name": "Sticky Note4"
      },
      {
        "parameters": {
          "content": "## Branche \u201cif type: videos\u201d\n\n",
          "height": 576,
          "width": 2112,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2640,
          2032
        ],
        "typeVersion": 1,
        "id": "ec5421b8-2955-4be5-9e5b-ccf645b4dc5a",
        "name": "Sticky Note5"
      },
      {
        "parameters": {
          "content": "## \u2705 STEP 3 \u2014 Cr\u00e9ation d'image avec DALL-E\nGoogle Sheets: Save Script Idea [Image] \u2192 sauvegarde l\u2019id\u00e9e d\u2019image dans une feuille Google.\n\nGenerate Image - DALL\u00b7E API \u2192 cr\u00e9e l\u2019image via DALL\u00b7E selon le script g\u00e9n\u00e9r\u00e9.\n\nEdit Fields (manual) \u2192 permet d\u2019\u00e9diter les r\u00e9sultats manuellement si n\u00e9cessaire.\n\nGoogle Sheets: Save Script Idea [Image] W/... \u2192 enregistre le r\u00e9sultat final dans la feuille.",
          "height": 208,
          "width": 880,
          "color": 6
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2176,
          1776
        ],
        "typeVersion": 1,
        "id": "11bea10b-cac7-47bf-ac10-4fd97e84d7d9",
        "name": "Sticky Note6"
      },
      {
        "parameters": {
          "content": "## Branche \u201cif type: text\u201d\n\n",
          "height": 672,
          "width": 1856,
          "color": 2
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -2640,
          2672
        ],
        "typeVersion": 1,
        "id": "f1b285cc-430f-42a2-a2ea-8bf47e07516b",
        "name": "Sticky Note7"
      },
      {
        "parameters": {
          "content": "# \u2705 STEP 5 \u2014 Cr\u00e9ation de Texte\n\nGoogle Sheets: Save Script Idea [Text] \u2192 sauvegarde l\u2019id\u00e9e texte.\n\nGenerate Text Content \u2192 g\u00e9n\u00e8re le contenu complet via OpenRouter Chat Model et Perplexity (pour compl\u00e9ter ou am\u00e9liorer).\n\nEdit Fields1 (manual) \u2192 possibilit\u00e9 de correction manuelle.\n\nGoogle Sheets: Log Final Texte Output \u2192 enregistre le texte final. ",
          "height": 280,
          "width": 1024
        },
        "id": "c6f953cc-e7c3-4598-a837-f460489f55e1",
        "name": "Sticky Note8",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -1616,
          2992
        ],
        "typeVersion": 1
      },
      {
        "parameters": {
          "content": "## \u2705 STEP 1 \u2014 G\u00e9n\u00e9ration du  Script & Prompt avec l'IA\n\nEntr\u00e9e : \u201cWhen chat message received\u201d \u2192 d\u00e9clenche le workflow lorsqu\u2019un message arrive.\n\nMod\u00e8le utilis\u00e9 : Google Gemini Chat Model\n\nOutils :\n\nTool Inject Creativity \u2192 pour enrichir et varier les id\u00e9es.\n\nParser: Extract JSON from Idea \u2192 transforme l\u2019id\u00e9e en format structur\u00e9 JSON.\n\nFonction : G\u00e9n\u00e8re un script ou un concept bas\u00e9 sur l\u2019entr\u00e9e utilisateur.\n\nSortie : Dirig\u00e9e selon le type (image, video, text) vers les blocs correspondants pour traitement.",
          "height": 464,
          "width": 1088
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -4448,
          2560
        ],
        "typeVersion": 1,
        "id": "29298a20-b3c7-4858-b29b-bfd06ecf5b5e",
        "name": "Sticky Note9"
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{\n  \"instagram_id\": \"1111\",\n  \"youtube_id\": \"1111\",\n  \"threads_id\": \"1111\",\n  \"tiktok_id\": \"1111\",\n  \"facebook_id\": \"1111\",\n  \"facebook_page_id\": \"1111\",\n  \"twitter_id\": \"1111\",\n  \"linkedin_id\": \"1111\",\n  \"pinterest_id\": \"1111\",\n  \"pinterest_board_id\": \"1111\",\n  \"bluesky_id\": \"1111\"\n}\n",
          "options": {}
        },
        "id": "c5e766a2-dcd9-491f-8eb2-2d4dee96c694",
        "name": "Assign Social Media IDs",
        "type": "n8n-nodes-base.set",
        "position": [
          0,
          2176
        ],
        "typeVersion": 3.4
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
            "mode": "url"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Sheet1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit#gid=0"
          },
          "options": {}
        },
        "id": "3bbf8803-1404-478f-926f-92941256bcb1",
        "name": "Get my video",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          96,
          1904
        ],
        "typeVersion": 4.5
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://backend.blotato.com/v2/media",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          },
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "url",
                "value": "={{ $('Get my video').item.json['final_output'] }}"
              }
            ]
          },
          "options": {}
        },
        "id": "042beea3-57d6-4cab-bf0b-107b3b1b23e2",
        "name": "Upload Video to Blotato",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          224,
          2176
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://backend.blotato.com/v2/posts",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.instagram_id }}\",\n    \"target\": {\n      \"targetType\": \"instagram\"\n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"instagram\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n\n",
          "options": {}
        },
        "id": "3b7c6b62-8798-4ebf-9507-7482d20b9447",
        "name": "INSTAGRAM",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          496,
          1904
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://backend.blotato.com/v2/posts",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.youtube_id }}\",\n    \"target\": {\n      \"targetType\": \"youtube\",\n      \"title\": \"{{ $('Get my video').item.json.Titre }}\",\n      \"privacyStatus\": \"unlisted\",\n      \"shouldNotifySubscribers\": \"false\"\n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"youtube\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "options": {}
        },
        "id": "c2ad37c7-0678-44bd-8dff-9622d1f56be5",
        "name": "YOUTUBE",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          720,
          1904
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://backend.blotato.com/v2/posts",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "=YOUR_API_HERE"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.tiktok_id }}\",\n    \"target\": {\n      \"targetType\": \"tiktok\",\n      \"isYourBrand\": \"false\", \n      \"disabledDuet\": \"false\",\n      \"privacyLevel\": \"PUBLIC_TO_EVERYONE\",\n      \"isAiGenerated\": \"true\",\n      \"disabledStitch\": \"false\",\n      \"disabledComments\": \"false\",\n      \"isBrandedContent\": \"false\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"tiktok\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "options": {}
        },
        "id": "333043c2-7ec0-41b1-b7e5-881961caaa8c",
        "name": "TIKTOK",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1120,
          1904
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://backend.blotato.com/v2/posts",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "=YOUR_API_HERE"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.facebook_id }}\",\n    \"target\": {\n      \"targetType\": \"facebook\",\n      \"pageId\": \"{{ $('Assign Social Media IDs').item.json.facebook_page_id }}\"\n\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"facebook\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}",
          "options": {}
        },
        "id": "235f4d51-51c8-428c-9e05-aa81be863ea4",
        "name": "FACEBOOK",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          496,
          2176
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://backend.blotato.com/v2/posts",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.threads_id }}\",\n    \"target\": {\n      \"targetType\": \"threads\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"threads\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "options": {}
        },
        "id": "3055cde0-a74f-4770-b1b2-441b5a670234",
        "name": "THREADS",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          720,
          2176
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://backend.blotato.com/v2/posts",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.twitter_id }}\",\n    \"target\": {\n      \"targetType\": \"twitter\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"twitter\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "options": {}
        },
        "id": "94af5d65-d6ea-4c45-b629-78262f232a03",
        "name": "TWETTER",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1120,
          2176
        ],
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://backend.blotato.com/v2/posts",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.linkedin_id }}\",\n    \"target\": {\n      \"targetType\": \"linkedin\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"linkedin\",\n      \"mediaUrls\": [\n        \"{{ $json.url }}\"\n      ]\n    }\n  }\n}\n",
          "options": {}
        },
        "id": "ab65f27f-84e2-4c6c-abea-adefa5fa6549",
        "name": "LINKEDIN",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          496,
          2416
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://backend.blotato.com/v2/posts",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "= {\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.bluesky_id }}\",\n    \"target\": {\n      \"targetType\": \"bluesky\"\n      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"bluesky\",\n      \"mediaUrls\": [\n        \"https://pbs.twimg.com/media/GE8MgIiWEAAfsK3.jpg\"\n      ]\n    }\n  }\n}\n",
          "options": {}
        },
        "id": "56498096-c214-42ec-913d-22b4544bc1b1",
        "name": "BLUESKY",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          720,
          2416
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://backend.blotato.com/v2/posts",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "blotato-api-key",
                "value": "YOUR_API_HERE"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"post\": {\n    \"accountId\": \"{{ $('Assign Social Media IDs').item.json.pinterest_id }}\",\n    \"target\": {\n      \"targetType\": \"pinterest\",\n      \"boardId\": \"{{ $('Assign Social Media IDs').item.json.pinterest_board_id }}\"      \n    },\n    \"content\": {\n      \"text\": \"{{ $('Get my video').item.json.DESCRIPTION }}\",\n      \"platform\": \"pinterest\",\n      \"mediaUrls\": [\n        \"https://pbs.twimg.com/media/GE8MgIiWEAAfsK3.jpg\"\n      ]\n    }\n  }\n}\n\n",
          "options": {}
        },
        "id": "6fe4a662-8539-4400-b485-23e8852ffc7c",
        "name": "PINTEREST",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          1120,
          2416
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "mode": "url",
            "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
            "__regex": "https:\\/\\/(?:drive|docs)\\.google\\.com(?:\\/.*|)\\/d\\/([0-9a-zA-Z\\-_]+)(?:\\/.*|)"
          },
          "sheetName": {
            "__rl": true,
            "value": "https://docs.google.com/spreadsheets/d/1E4TEGOpxNGwsAluoFazWEesRdPbiJXX1gqFNfKgL3dE/edit?gid=0#gid=0",
            "mode": "url"
          },
          "columns": {
            "value": {
              "STATUS": "Publish",
              "row_number": "={{ $('Get my video').item.json.row_number }}"
            },
            "schema": [
              {
                "id": "PROMPT",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "PROMPT",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "DESCRIPTION",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "DESCRIPTION",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "URL VIDEO",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "URL VIDEO",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "Titre",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "Titre",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "STATUS",
                "type": "string",
                "display": true,
                "required": false,
                "displayName": "STATUS",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              },
              {
                "id": "row_number",
                "type": "string",
                "display": true,
                "removed": false,
                "readOnly": true,
                "required": false,
                "displayName": "row_number",
                "defaultMatch": false,
                "canBeUsedToMatch": true
              }
            ],
            "mappingMode": "defineBelow",
            "matchingColumns": [
              "row_number"
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "id": "d47c9164-5755-474d-b6b7-293689c3f03b",
        "name": "Google Sheets",
        "type": "n8n-nodes-base.googleSheets",
        "position": [
          224,
          2416
        ],
        "typeVersion": 4.5,
        "disabled": true
      },
      {
        "parameters": {
          "content": "# \u2705 STEP 3 \u2014 Publish Video to Social Media\n",
          "height": 760,
          "width": 1200,
          "color": 4
        },
        "id": "6ade3588-a66c-4d1e-9596-2eb30740f757",
        "name": "Sticky Note10",
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          -128,
          1808
        ],
        "typeVersion": 1
      },
      {
        "parameters": {
          "url": "={{ $json.data[0].url }}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -2688,
          736
        ],
        "id": "7d7abbef-08c2-40f2-bb87-c73bcec05288",
        "name": "HTTP Request1"
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.infip.pro/v1/images/generations",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "sendBody": true,
          "contentType": "raw",
          "rawContentType": "application/json",
          "body": "={\n  \"model\": \"img3\",\n  \"prompt\": \"Un assistant IA professionnel travaillant sur une interface futuriste, style corporate, fond clair\",\n  \"n\": 1,\n  \"size\": \"1024x1024\"\n}\n",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 2000
              }
            }
          }
        },
        "id": "ef9e73ae-0e6c-46c9-808d-37a353d16ab2",
        "name": "Call image with Ghostbot web",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -2912,
          736
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.infip.pro/v1/images/generations",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "sendBody": true,
          "contentType": "raw",
          "rawContentType": "application/json",
          "body": "={\n  \"model\": \"img3\",\n  \"prompt\": \"{{ $json.output.prompt_ameliore }}\",\n  \"n\": 1,\n  \"size\": \"1024x1024\"\n}\n",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 2000
              }
            }
          }
        },
        "id": "daa73726-b6e2-4f7e-8b56-f8ac3b911675",
        "name": "Call image with Ghostbot web1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -2288,
          1232
        ],
        "typeVersion": 4.2,
        "disabled": true
      },
      {
        "parameters": {
          "url": "={{ $json.data[0].url }}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -2032,
          1232
        ],
        "id": "0d77d702-237d-424b-b77f-e21ce4b64cab",
        "name": "HTTP Request2"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          -4016,
          2416
        ],
        "id": "c5fcb121-2ffb-4341-a1d4-b6d5507a6dbe",
        "name": "Google Gemini Chat Model1",
        "credentials": {
          "googlePalmApi": {
            "id": "juqopekTUW4CU0nb",
            "name": "Google Gemini API"
          }
        }
      },
      {
        "parameters": {
          "url": "={{ $json.choices[0].message.images[0].image_url.url }}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -3280,
          720
        ],
        "id": "49d970ce-4bad-4fb8-9c3f-70f3ce4587b8",
        "name": "HTTP Request3",
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://openrouter.ai/api/v1/chat/completions",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "openRouterApi",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "{\n    \"model\": \"google/gemini-2.5-flash-image-preview\",\n    \"messages\": [\n      {\n        \"role\": \"user\",\n        \"content\": [\n          {\n            \"type\": \"text\",\n            \"text\": \"genere moi une image de chat qui dort\"\n          }\n        ]\n      }\n    ]\n  }",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 2000
              }
            }
          }
        },
        "id": "b1dfea58-9760-4f11-9e89-6bf12cec9bce",
        "name": "nano  banana",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -3472,
          720
        ],
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://openrouter.ai/api/v1/chat/completions",
          "authentication": "predefinedCredentialType",
          "nodeCredentialType": "openRouterApi",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "\n\n{\n  \"model\": \"google/gemini-2.0-flash-001\",\n  \"messages\": [\n      {\n        \"role\": \"user\",\n        \"content\": [\n          {\n            \"type\": \"text\",\n            \"text\": \"THEME, LES AMIES, arguemnte l\u00e0-dessus\"\n          }\n        ]\n    \n      }\n  ]\n}",
          "options": {}
        },
        "id": "b5690ccd-bfe4-4ad3-ba21-c2e071e1c6df",
        "name": "nano  banana1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -3824,
          736
        ],
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "messages": {
            "message": [
              {}
            ]
          },
          "options": {},
          "requestOptions": {}
        },
        "type": "n8n-nodes-base.perplexityTool",
        "typeVersion": 1,
        "position": [
          -1760,
          3008
        ],
        "id": "3c24fefa-df38-465b-aafa-2b236c309d88",
        "name": "Message a model in Perplexity",
        "disabled": true
      },
      {
        "parameters": {
          "schemaType": "manual",
          "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"type_contenu\": {\n      \"type\": \"string\",\n      \"enum\": [\"image\", \"video\", \"texte\", \"social_post\"],\n      \"description\": \"Type de contenu: image, video, texte ou social_post pour les r\u00e9seaux sociaux\"\n    },\n    \"platform\": {\n      \"type\": \"string\",\n      \"enum\": [\"linkedin\", \"instagram\", \"twitter\", \"facebook\"],\n      \"description\": \"Plateforme sociale (uniquement pour social_post)\"\n    },\n    \"post_content\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"text\": {\"type\": \"string\", \"description\": \"Texte du post en markdown\"},\n        \"hook\": {\"type\": \"string\", \"description\": \"Accroche principale\"},\n        \"cta\": {\"type\": \"string\", \"description\": \"Call-to-action\"}\n      },\n      \"description\": \"Contenu du post social (uniquement pour social_post)\"\n    },\n    \"prompt_ameliore\": {\n      \"type\": \"string\",\n      \"description\": \"Prompt enrichi pour image/video\"\n    },\n    \"image_prompt\": {\n      \"type\": \"string\",\n      \"description\": \"Prompt pour g\u00e9n\u00e9rer l'image du post social\"\n    },\n    \"generate_image\": {\n      \"type\": \"boolean\",\n      \"description\": \"True pour g\u00e9n\u00e9rer une image avec le post\"\n    },\n    \"description\": {\n      \"type\": \"string\",\n      \"description\": \"Courte description engageante\"\n    },\n    \"hashtags\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Liste des hashtags\"\n    },\n    \"keywords\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Mots-cl\u00e9s principaux\"\n    }\n  },\n  \"required\": [\"type_contenu\"]\n}"
        },
        "id": "38af37f3-3358-407d-8674-7f9b3f6e3457",
        "name": "Parser: Extract JSON from Idea1",
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "position": [
          -1856,
          3168
        ],
        "typeVersion": 1.2,
        "disabled": false
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.heygen.com/v2/video/generate \\",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpHeaderAuth",
          "sendBody": true,
          "contentType": "raw",
          "rawContentType": "application/json",
          "body": "={ \"prompt\": \"{{ $json.output }}\" }\n",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 2000
              }
            }
          }
        },
        "id": "c39691ad-b712-4538-91c2-454e4f63ec2b",
        "name": "Call Veo3 API to Generate Video1",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -1696,
          2352
        ],
        "typeVersion": 4.2
      },
      {
        "parameters": {
          "method": "POST",
          "url": "https://api.heygen.com/v2/video/generate",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              },
              {
                "name": "x-api-key",
                "value": "sk_V2_hgu_kvNnNd87EZS_J5TPFNMjEWndNPsL04vBxJo5aWMkETa7"
              }
            ]
          },
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"video_inputs\": [\n    {\n      \"character\": {\n        \"type\": \"avatar\",\n        \"avatar_id\": \"Lina_Dress_Sitting_Side_public\",\n        \"avatar_style\": \"normal\"\n      },\n      \"voice\": {\n        \"type\": \"text\",\n        \"input_text\": \"g\u00e9n\u00e9re moi une vid\u00e9os d'une silhouette colossale et hirsute, sa fourrure incrust\u00e9e de glace et de neige, appara\u00eet dans le cadre, tenant un appareil photo grossier d\u2019une main massive et griffue. L\u2019objectif est flou, laissant entrevoir les conditions arctiques brutales, cr\u00e9ant un plan intime de type found footage, comme s\u2019il d\u00e9couvrait un monde sauvage cach\u00e9. Les yeux de la cr\u00e9ature, brillants et intelligents, scrutent de derri\u00e8re ses sourcils hirsutes alors qu\u2019elle tente de garder une attitude joyeuse au milieu de la temp\u00eate de neige d\u00e9cha\u00een\u00e9e, son souffle embuant l\u2019air autour d\u2019elle. Il d\u00e9place son immense poids, un grondement sourd dans sa poitrine, comme s\u2019il s\u2019appr\u00eatait \u00e0 lancer une chute, capturant le brut,et on vois des annimaux qui rigol\u00e9e aussi et d'autres qui boivent du caf\u00e9\",\n        \"voice_id\": \"119caed25533477ba63822d5d1552d25\",\n        \"speed\": 1.0\n      }\n    }\n  ],\n  \"dimension\": {\n    \"width\": 1280,\n    \"height\": 720\n  }\n}\n",
          "options": {
            "batching": {
              "batch": {
                "batchSize": 1,
                "batchInterval": 2000
              }
            }
          }
        },
        "id": "84d70432-8818-474b-88c3-85befe1e84c3",
        "name": "Heygen video",
        "type": "n8n-nodes-base.httpRequest",
        "position": [
          -1840,
          2144
        ],
        "typeVersion": 4.2,
        "alwaysOutputData": true
      },
      {
        "parameters": {
          "url": "=https://api.heygen.com/v1/video_status.get \\",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "accept",
                "value": "application/json"
              },
              {
                "name": "x-api-key",
                "value": "sk_V2_hgu_kvNnNd87EZS_J5TPFNMjEWndNPsL04vBxJo5aWMkETa7"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.3,
        "position": [
          -1584,
          2144
        ],
        "id": "0e1ba483-51f7-4b53-b88d-df8d3f057d18",
        "name": "HTTP Request4"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          -1808,
          1456
        ],
        "id": "f889d461-a1ed-44b5-98df-94aea3c62d1b",
        "name": "Merge"
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -2320,
          1456
        ],
        "id": "52f496af-38d4-460a-aa58-4fc4dcdbe833",
        "name": "Edit Fields2"
      },
      {
        "parameters": {
          "httpRequestMethod": "POST",
          "graphApiVersion": "v23.0",
          "node": "26048161544789551",
          "options": {}
        },
        "type": "n8n-nodes-base.facebookGraphApi",
        "typeVersion": 1,
        "position": [
          -512,
          2960
        ],
        "id": "eb5d1f47-23f3-455b-b39a-5c98737aebe0",
        "name": "Facebook Graph API",
        "alwaysOutputData": false,
        "disabled": true
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "af23eea9-aba6-48e0-b52c-31699c5ceed0",
                "name": "link",
                "value": "={{ $json.link }}",
                "type": "string"
              },
              {
                "id": "4571e73b-56b1-4453-bb95-a26ed2fd9ce1",
                "name": "name",
                "value": "={{ $json.name }}",
                "type": "string"
              },
              {
                "id": "ad1fc1ff-411c-4582-af1b-bfdab400c689",
                "name": "id",
                "value": "={{ $json.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -208,
          2944
        ],
        "id": "6434803f-a6cc-436c-a33e-29404d31ad21",
        "name": "Edit Fields3"
      },
      {
        "parameters": {
          "httpRequestMethod": "POST",
          "graphApiVersion": "v20.0",
          "node": "26048161544789551",
          "edge": "photos",
          "options": {
            "queryParameters": {
              "parameter": [
                {
                  "name": "message",
                  "value": "={{ $json.output.texte_genere }}\n\n"
                }
              ]
            }
          }
        },
        "id": "ad2164d0-9963-460f-890f-efb8570ef40c",
        "name": "Facebook Post",
        "type": "n8n-nodes-base.facebookGraphApi",
        "position": [
          -448,
          3280
        ],
        "typeVersion": 1,
        "alwaysOutputData": true,
        "onError": "continueRegularOutput",
        "disabled": true
      },
      {
        "parameters": {
          "postAs": "organization",
          "organization": "12345678",
          "text": "={{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.post }}\n{{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.call_to_action }}\n{{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.hashtags }}\n{{ $('Social Media Content Factory').item.json.output.platform_posts.LinkedIn.call_to_action }}",
          "shareMediaCategory": "IMAGE",
          "binaryPropertyName": "=data",
          "additionalFields": {}
        },
        "id": "a1c641bc-50cc-4cea-9797-e0a7c57954ed",
        "name": "LinkedIn Post",
        "type": "n8n-nodes-base.linkedIn",
        "position": [
          -720,
          3440
        ],
        "typeVersion": 1,
        "alwaysOutputData": true,
        "onError": "continueRegularOutput",
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "// Get the image binary data\nconst items = $input.all();\nconst results = [];\n\nfor (const item of items) {\n  const binary = item.binary?.data;\n  \n  if (binary) {\n    // Get the base64 data\n    const base64Data = await this.helpers.getBinaryDataBuffer(items[0], 'data');\n    const base64String = base64Data.toString('base64');\n    \n    results.push({\n      json: {\n        type: 'image',\n        mimeType: binary.mimeType,\n        image_base64: base64String,\n        description: $('AI Agent: Generate Video Concept').first().json.output?.description || '',\n        prompt: $('AI Agent: Generate Video Concept').first().json.output?.prompt_ameliore || ''\n      }\n    });\n  } else {\n    results.push({\n      json: {\n        type: 'image',\n        error: 'No image generated'\n      }\n    });\n  }\n}\n\nreturn results;"
        },
        "id": "convert-image-base64",
        "name": "Convert Image to Base64",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -3600,
          1600
        ]
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "79785419-cff6-47ec-8b20-ba8522803cf5",
          "options": {},
          "responseMode": "responseNode"
        },
        "id": "f461fd74-c81a-4c6f-acae-6d8fe21301b9",
        "name": "Webhook",
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          -3968,
          1968
        ],
        "webhookId": "79785419-cff6-47ec-8b20-ba8522803cf5"
      },
      {
        "parameters": {
          "jsCode": "// Sauvegarder l'image dans /tmp pour que le frontend puisse la r\u00e9cup\u00e9rer\nconst fs = require('fs');\nconst base64 = $json.base64;\nconst sessionId = $('When chat message received').first().json.sessionId || 'unknown';\n\n// Cr\u00e9er un fichier JSON avec l'image\nconst imageData = {\n    base64: base64,\n    mimeType: $json.mimeType || 'image/png',\n    description: $('AI Agent: Generate Video Concept').first().json.output.description,\n    hashtags: $('AI Agent: Generate Video Concept').first().json.output.hashtags,\n    timestamp: new Date().toISOString(),\n    ready: true\n};\n\nconst filePath = `/tmp/n8n-image-${sessionId}.json`;\nfs.writeFileSync(filePath, JSON.stringify(imageData));\n\nreturn { json: { ...imageData, filePath } };"
        },
        "id": "save-image-file",
        "name": "Save Image to File",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -4400,
          1952
        ]
      },
      {
        "parameters": {
          "respondWith": "json",
          "responseBody": "={{ $json }}",
          "options": {}
        },
        "id": "respond-with-image-data",
        "name": "Respond with Image Data",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.1,
        "position": [
          -4200,
          1952
        ]
      }
    ],
    "connections": {
      "Webhook - Receive Campaign Brief": {
        "main": [
          [
            {
              "node": "Workflow Configuration",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Video - API": {
        "main": [
          [
            {
              "node": "Publish to Platform - Buffer API",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Publish to Platform - Buffer API": {
        "main": [
          [
            {
              "node": "Respond - Content Published",
              "type": "main",
              "index": 0
            },
            {
              "node": "Wait 7 Days",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait 7 Days": {
        "main": [
          [
            {
              "node": "Fetch Performance Stats",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Performance Stats": {
        "main": [
          [
            {
              "node": "Format Performance Report",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format Performance Report": {
        "main": [
          [
            {
              "node": "Send Report Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent: Generate Video Concept": {
        "main": [
          [
            {
              "node": "if type : image",
              "type": "main",
              "index": 0
            },
            {
              "node": "if type : vid\u00e9os",
              "type": "main",
              "index": 0
            },
            {
              "node": "if type : text",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Tool: Inject Creativity": {
        "ai_tool": [
          [
            {
              "node": "AI Agent: Generate Video Concept",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Parser: Extract JSON from Idea": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent: Generate Video Concept",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "When chat message received": {
        "main": [
          [
            {
              "node": "AI Agent: Generate Video Concept",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "if type : vid\u00e9os": {
        "main": [
          [
            {
              "node": "Google Sheets: Save Script Idea [ Vid\u00e9os]",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "if type : image": {
        "main": [
          [
            {
              "node": "Generate an image",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "if type : text": {
        "main": [
          [
            {
              "node": "Google Sheets: Save Script Idea [ Texte ]",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate an image": {
        "main": [
          [
            {
              "node": "Convert Image to Base64",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Tool: Build Prompt Structure": {
        "ai_tool": [
          [
            {
              "node": "AI Agent: Create Veo3-Compatible Prompt",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Auto-fixing Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "AI Agent: Create Veo3-Compatible Prompt",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "AI Agent: Create Veo3-Compatible Prompt": {
        "main": [
          [
            {
              "node": "Heygen video",
              "type": "main",
              "index": 0
            },
            {
              "node": "Call Veo3 API to Generate Video1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Call Veo3 API to Generate Video": {
        "main": [
          [
            {
              "node": "Wait for Veo3 Processing (5 mins)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Wait for Veo3 Processing (5 mins)": {
        "main": [
          [
            {
              "node": "Retrieve Final Video URL from Veo3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Retrieve Final Video URL from Veo3": {
        "main": [
          [
            {
              "node": "Google Sheets: Log Final Video Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent: Create Veo3-Compatible Prompt",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Auto-fixing Output Parser",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets: Save Script Idea [ Vid\u00e9os]": {
        "main": [
          [
            {
              "node": "AI Agent: Create Veo3-Compatible Prompt",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets: Save Script Idea [ Image ]": {
        "main": [
          [
            {
              "node": "Call image with Ghostbot web1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Google Sheets: Save Script Idea [ Image ] With URL",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Sheets: Save Script Idea [ Texte ]": {
        "main": [
          [
            {
              "node": "Generate Text Content",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Text Content": {
        "main": [
          [
            {
              "node": "Edit Fields1",
              "type": "main",
              "index": 0
            },
            {
              "node": "Facebook Graph API",
              "type": "main",
              "index": 0
            },
            {
              "node": "Facebook Post",
              "type": "main",
              "index": 0
            },
            {
              "node": "LinkedIn Post",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields1": {
        "main": [
          [
            {
              "node": "Google Sheets: Log Final Texte Output",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Assign Social Media IDs": {
        "main": [
          [
            {
              "node": "Upload Video to Blotato",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get my video": {
        "main": [
          [
            {
              "node": "Assign Social Media IDs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Video to Blotato": {
        "main": [
          [
            {
              "node": "INSTAGRAM",
              "type": "main",
              "index": 0
            },
            {
              "node": "YOUTUBE",
              "type": "main",
              "index": 0
            },
            {
              "node": "TIKTOK",
              "type": "main",
              "index": 0
            },
            {
              "node": "FACEBOOK",
              "type": "main",
              "index": 0
            },
            {
              "node": "THREADS",
              "type": "main",
              "index": 0
            },
            {
              "node": "TWETTER",
              "type": "main",
              "index": 0
            },
            {
              "node": "LINKEDIN",
              "type": "main",
              "index": 0
            },
            {
              "node": "BLUESKY",
              "type": "main",
              "index": 0
            },
            {
              "node": "PINTEREST",
              "type": "main",
              "index": 0
            },
            {
              "node": "Google Sheets",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Call image with Ghostbot web": {
        "main": [
          [
            {
              "node": "HTTP Request1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Call image with Ghostbot web1": {
        "main": [
          [
            {
              "node": "HTTP Request2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "AI Agent: Generate Video Concept",
              "type": "ai_languageModel",
              "index": 0
            },
            {
              "node": "Generate Text Content",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "HTTP Request2": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "nano  banana": {
        "main": [
          [
            {
              "node": "HTTP Request3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parser: Extract JSON from Idea1": {
        "ai_outputParser": [
          [
            {
              "node": "Generate Text Content",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Heygen video": {
        "main": [
          [
            {
              "node": "HTTP Request4",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Facebook Graph API": {
        "main": [
          [
            {
              "node": "Edit Fields3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook": {
        "main": [
          [
            {
              "node": "AI Agent: Generate Video Concept",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Convert Image to Base64": {
        "main": [
          [
            {
              "node": "Save Image to File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Save Image to File": {
        "main": [
          [
            {
              "node": "Respond with Image Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Chalopin Nicolas",
    "name": null,
    "description": null,
    "autosaved": false,
    "workflowPublishHistory": [
      {
        "createdAt": "2025-12-28T19:59:25.414Z",
        "id": 64,
        "workflowId": "J5Phg4QikbYSJjsv",
        "versionId": "eb95d52c-8f80-44a9-9add-c90a4e87f067",
        "event": "activated",
        "userId": "feeae7df-7e7e-414d-9264-f7b6ef5fd7c5"
      }
    ]
  }
}